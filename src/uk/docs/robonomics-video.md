---
title: Сервіс відео Robonomics
contributors: [nakata5321]
---

У цій статті показано, як додати IP-камеру до додатка Home Assistant та надсилати відео на веб-сервіс Robonomics.

Щоб підключити камеру до додатка Home Assistant, вам потрібно знати його IP-адресу та створити локальний обліковий запис камери для підключення до потоку RTSP.

{% roboWikiNote {type: "warning"}%} Оскільки це робиться по-різному для кожної камери, цей процес не розглядається в цій статті.
{% endroboWikiNote %}

Вимоги:
- IP-камера
- Налаштований локальний обліковий запис камери
- IP-адрес камери
- Налаштований Home Assistant

{% roboWikiNote {type: "warning"}%} Ця стаття передбачає, що у вас є загальна IP-камера без опцій RTZ (поворот, нахил, збільшення). Якщо у вас є камера RTZ, перевірте статтю ["Камера RTZ"](docs/ptz-camera). А потім поверніться до другого кроку тут. {% endroboWikiNote %}

## Підключіть камеру

Спочатку вам потрібно дізнатися URL-адресу потоку RTSP камери.
Для цього спробуйте ввести наступний запит в Інтернеті: "<НАЗВА КАМЕРИ> потік RTSP".
URL потоку повинен починатися з `rtsp://<IP-адрес>...`.

У цій статті використовується камера "Tapo", а шлях потоку - `rtsp://<IP-адрес>/stream1`.

Відкрийте Home Assistant та перейдіть до "Налаштування"-> "Пристрої та сервіси". Натисніть кнопку "ДОДАТИ ІНТЕГРАЦІЮ" та
почніть вводити інтеграцію "Загальна камера". Виберіть її.

{% roboWikiPicture {src:"docs/home-assistant/generic.jpg", alt:"hass"} %}{% endroboWikiPicture %}

У вікні конфігурації надайте наступну інформацію:
- URL джерела потоку - URL потоку RTSP камери
- Ім'я користувача - введіть ім'я користувача вашого локального облікового запису камери
- Пароль - введіть пароль для вашого локального облікового запису камери

{% roboWikiPicture {src:"docs/home-assistant/genericconf.jpg", alt:"genericconf"} %}{% endroboWikiPicture %}

Прокрутіть налаштування вниз і натисніть кнопку "Надіслати".

У вікні попереднього перегляду активуйте прапорець "Це зображення виглядає добре." та натисніть кнопку "Надіслати". Потім - "Завершити".

{% roboWikiPicture {src:"docs/home-assistant/preview-camera.jpg", alt:"preview-camera"} %}{% endroboWikiPicture %}

### Додати на панель керування

Крім того, ви можете додати потік на свою панель керування. Для цього перейдіть на панель керування та створіть нову картку "Зображення на перший погляд". Додаткові кроки:
- введіть "Назву", яку ви хочете
- видаліть дані з "Шлях до зображення"
- виберіть камеру в "Сутність камери"
- у "Вид камери" виберіть "живий", щоб зменшити затримку

І збережіть це.
{% roboWikiPicture {src:"docs/home-assistant/camera_picture_glance.jpg", alt:"camera_picture_glance"} %}{% endroboWikiPicture %}

## Перевірка папки з медіафайлами

Перш ніж відео буде відправлено на сервіс відео Robonomics, його потрібно зберегти в папці, і Home Assistant повинен мати доступ до цієї папки.
Найпростіший варіант у цьому випадку - використовувати медіапак, в якому Home Assistant зберігає всі медіафайли.

- Якщо ви використовуєте HAOS або встановлене зображення, ваш Home Assistant **вже має папку з медіафайлами**.
- Якщо ви використовуєте Home Assistant Core, вам слід перейти до папки `.homeassistant` та створити в ній папку `media`.
- Якщо ви використовуєте Home Assistant Docker, додайте рядок ` -v /ШЛЯХ_ДО_ВАШИХ_МЕДІАФАЙЛІВ:/media \` до команди Docker.

Щоб переконатися, що все налаштовано правильно, перейдіть на вкладку "Медіа" -> "локальні медіафайли" у вашому Home Assistant.
Ви повинні побачити порожню папку (без помилок):

{% roboWikiPicture {src:"docs/home-assistant/media-folder.jpg", alt:"media-folder"} %}{% endroboWikiPicture %}

## Виклик сервісу

Щоб відправити відео на Robonomics, вам слід викликати відповідний сервіс в Home Assistant.
У цій статті це робиться вручну, але ви можете створити для цього автоматизацію.

Для цього перейдіть до "Інструменти розробника" -> "Сервіси" та знайдіть "Robonomics: Зберегти запис на Robonomics".

{% roboWikiPicture {src:"docs/home-assistant/robonomics-service.jpg", alt:"robonomics-service"} %}{% endroboWikiPicture %}

У "Цілях" виберіть вашу сутність камери.
У "Шлях до збереження запису" ви повинні вказати абсолютний шлях до папки, де Home Assistant може зберегти відео:
- Для встановленого зображення - `/home/homeassistant/.homeassistant/media`;
- Для HA OS або Home Assistant Docker - `/media`.`;
- Для Home Assistant Core - Шлях до раніше створеної папки для медіафайлів.

Крім того, ви можете вибрати тривалість запису.

Заповніть дані та викличте сервіс, натиснувши кнопку "ВИКЛИКАТИ СЕРВІС".

## DAPP

Щоб переглянути відео, перейдіть на [Robonomics DAPP](https://vol4tim.github.io/videostream/).

{% roboWikiPicture {src:"docs/home-assistant/video-dapp.jpg", alt:"video-dapp"} %}{% endroboWikiPicture %}

Вставте адресу облікового запису вашого контролера та натисніть кнопку нижче. Зачекайте на процес "Пошук близнюків".
В результаті ви отримаєте IPFS CID з усіма записаними відео.

{% roboWikiPicture {src:"docs/home-assistant/video-ipfs.jpg", alt:"video-ipfs"} %}{% endroboWikiPicture %}

Потім виберіть обліковий запис контролера (або будь-який інший) зі списку та підпишіть повідомлення для авторизації в
веб-порталі Web3 IPFS для завантаження всіх відео. В результаті ви отримаєте всі відео, записані вашим розумним будинком.

{% roboWikiPicture {src:"docs/home-assistant/show-videos.jpg", alt:"show-videos"} %}{% endroboWikiPicture %}

Оскільки всі відео в папці зашифровані ключем контролера, вам потрібно вставити його для розшифрування відео.
Після цього кнопка відтворення відео активується. Натисніть на неї, щоб завантажити відео.

{% roboWikiPicture {src:"docs/home-assistant/video-seed.jpg", alt:"video-seed"} %}{% endroboWikiPicture %}

