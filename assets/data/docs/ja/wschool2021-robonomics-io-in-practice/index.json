{"hash":"ceab3a429752c97dd7c65a5079afb3c9f530d7f5","data":{"doc":{"id":"b8722d50ca16de4db896fffa11c203a9","title":"Lesson 3, Robonomics IOの実践","description":"","contributors":["KiichiSugihara"],"translated":true,"headings":[],"subtitles":[{"depth":2,"value":"必要なもの","anchor":"#必要なもの"},{"depth":3,"value":"SDS011の確認 (オプション)","anchor":"#sds011の確認-オプション"},{"depth":2,"value":"クイックスタート","anchor":"#クイックスタート"},{"depth":2,"value":"IPFSへのアクセス","anchor":"#ipfsへのアクセス"},{"depth":2,"value":"Robonomics のデータログ","anchor":"#robonomics-のデータログ"}],"content":"import Asciinema from '~/components/Asciinema.vue'\n\n## 必要なもの\n\n* Dockerが必要です、最初に[install](https://docs.docker.com/engine/install/)してください。\n* [Nova SDS011](https://aqicn.org/sensor/sds011) センサーは*オプション*です。\n\n### SDS011の確認 (オプション)\n\nSDS011センサーを接続した場合、それが`/dev`に表示され、正しいアクセス権を持っていることを確認してください。\n\n<Asciinema vid=\"WCFcx8C6M8e52UKDNei1xZloU\"/>\n\n## クイックスタート\n\nDockerのインストールが完了したら、公式リポジトリから[robonomicsのdockerイメージ](https://hub.docker.com/r/robonomics/robonomics)を起動します。このレッスンでは `winter-school `タグを使用します。\n\n<Asciinema vid=\"wM43jozIVfcRmt52ENrJ6yPlH\"/>\n\nDockerイメージの準備ができたら、`robonomics io`コマンド（SDS011デバイスを持っている場合はoptionで指定）を使ってデータを読み込んでみましょう。\n\n<Asciinema vid=\"iztt22tKGaV8wq3cMXY1oUEYv\"/>\n\nSDS011センサーがない場合は、`vsds011.sh`を使って同じDockerコンテナ内にある仮想のSDS011センサーを自由に使うことができます。続くコマンドの中では、物理的なセンサーの代わりに透過的に使用してください。\n\n\n<Asciinema vid=\"GCkSiJBA1DgpLAAHiMhIOSpgG\"/>\n\nRobonomics IO サブシステムには2種類のコマンドがあります:\n\n* `read` - 読み込みアクセスをサポートするデバイスからデータを取得する。\n* `write` - 書き込みアクセスをサポートするデバイスにデータを書き込む。\n\nデバイスによっては両方をサポートしているものもあり、その場合には両方のコマンドの引数にデバイスが表示されます。\n\n> 例えば、仮想デバイス `ipfs` は、ハッシュによる IPFS からのデータの`read`(読み取り)と、IPFS へのデータの`write`(書き込み)をサポートしています。\n\nサポートされているデバイスの全リストは、引数なしで `robonomics io read`または `robonomics io write` を実行することで得られます。\n\n## IPFSへのアクセス\n次のステップでは、IPFSデーモンの起動が必要です。そのためには、`ipfs init`を実行し、専用のターミナルタブでデーモンを起動します。\n\n<Asciinema vid=\"ir6ziXSBUDrRltTmNxg7sdXVY\"/>\n\nデーモンが起動すると、別のタブでdockerイメージを接続し、`robonomics io`を使ってデータを読み書きできるようになります。\n\n<Asciinema vid=\"ZtwcmpB9Lhum2Sc221QmNwHG4\"/>\n\nSDS011センサーのデータをIPFSに転送するには、コンソールの`｜`(パイプ)シンボルを使います。実際にやってみましょう。\n\n\n<Asciinema vid=\"XS0QESWG7f8ELsQe1bGQllb9O\"/>\n\nSDS011からのJSONデータがIPFS書き込みの入力として転送され、その結果が標準出力に出力されます。\n\nFor virtual sensor use:\n```\nvsds011.sh | robonomics io write ipfs\n```\n\nこの方法を使えば `robonomics io`ツールのプリミティブな読み取りと書き込みを組み合わせるだけで、簡単なプログラムを簡単に作ることができます。\n\n\n```bash\nrobonomics io read sds011 | gz | robonomics io write pubsub my-sensor-data\n```\n\n## Robonomics のデータログ\n\n> Robonomics[Datalog](https://crates.robonomics.network/pallet_robonomics_datalog/index.html) のターゲットはデータのブロックチェーン化です。このパレットは、カスタムデータをブロックチェーンに保存して、将来変更できないようにする機能を提供します。\n\nこのレッスンの最後の部分では、robonomicsノードを実行する必要があります。ブロックタイムが短く、あらかじめ設定された口座にすでに残高が分散されているため、開発モードが好まれます。同じコンテナ内の別のターミナルタブで起動してみましょう。\n\n<Asciinema vid=\"QnN9l0sdaZZOyK9ah0DntvCXt\"/>\n\n\nまた、`datalog`デバイスの引数としてprivateなシード値が必要です。このシード値は、取引に署名するために使用され、アカウントを送信者として提示します。組み込まれている`robonomics key`コマンドを使って生成してみましょう。\n\n\n<Asciinema vid=\"4Cdfl9F0GgjNWv1c1ZcTBBktF\"/>\n\n生成したアドレスとシード値は安全な場所に保存しておいてください。\n\n現在、アドレスの残高はゼロで、ネットワークはこのアドレスからの取引の送信を許可していません。この問題を解決するために、`Alice`アカウントからトークンを送金しましょう。https://parachain.robonomics.network の Robonomics Portal を使って、 `ws://127.0.0.1:9944`というアドレスのローカルノードに接続してみましょう。\n\n\n![portal transfer](../images/ws_lesson3/tran.jpg)\n\n\nそして、任意のデータをブロックチェーンに保存するために、`datalog`デバイスを使用することができます。`-s`keyは、アカウントの秘密シード値を設定するために使用されます。取引を行うためには、口座の残高がゼロでないことが必要です。\n\n<Asciinema vid=\"FzERH9TmFB8oRuas8ZU202Pv8\"/>\n\nすべてが正しく行われていれば、Robonomicsポータルの`Explorer`ページに`Datalog`イベントが表示されます。\n\n\n![portal datalog](../images/ws_lesson3/datalog.jpg)\n\n\n最後のステップは少し複雑ですが、このレッスンのすべての知識を使ってみるのもいいでしょう。SDS011センサー（またはファイル）からデータを収集し、それをIPFSに格納し、`datalog`トランザクションを送信してブロックチェーンにハッシュを保存する簡単なプログラムを作ってみましょう。\n\n\n```\nSDS011 -> IPFS -> Blockchain\n```\n\nRobonomics IOを使って簡単に実装できますので、やってみましょう。\n\n\n<Asciinema vid=\"MTpiawGo8DKEn081OozbYb5mU\"/>\n\nFor virtual sensor use:\n```\nvsds011.sh | robonomics io write ipfs | robonomics io write datalog -s <private_key>\n```\n\n\nうまくいけば、IPFSのハッシュを含む`Datalog`イベントが提示されるはずです。\n\n![portal datalog complex](../images/ws_lesson3/datalog_complex.jpg)\n","tools":[],"fileInfo":{"path":"ja/wschool2021-robonomics-io-in-practice.md","name":"wschool2021-robonomics-io-in-practice"}}},"context":{}}