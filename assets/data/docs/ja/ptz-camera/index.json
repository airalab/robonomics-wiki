{"hash":"3f5dbcf25038fb82d4541254c2b3842511271503","data":{"doc":{"id":"70b4136b026a129d07b94234b4bf8c61","title":"Home AssistantでのPTZカメラ制御","description":"","contributors":["nakata5321"],"headings":[],"subtitles":[{"depth":2,"value":"ONVIF統合","anchor":"#onvif統合"},{"depth":2,"value":"ダッシュボードにカメラ制御を追加する","anchor":"#ダッシュボードにカメラ制御を追加する"},{"depth":2,"value":"トラブルシューティング","anchor":"#トラブルシューティング"}],"content":"\nこの記事では、Home AssistantでのPTZカメラのセットアップのプロセスについて説明します。 \nONVIFプロトコルが使用されます。これにはローカルカメラアカウントが必要です。\n\n<robo-wiki-note type=\"warning\">\nローカルカメラアカウントの設定手順は、この記事では説明されていません。\n</robo-wiki-note>\n\n要件:\n- PTZカメラ\n- ローカルカメラアカウント\n- カメラのIPアドレス\n- 設定済みのHome Assistant\n\n## ONVIF統合\n\n**ONVIF統合**のインストールから始めましょう。 \n\n「Settings」の「Devices & Services」に移動し、「ADD INTEGRATION」ボタンを押します。\n「ONVIF」と入力し、統合を選択します。次のウィンドウが表示されます。\n\n <robo-wiki-picture src=\"home-assistant/onvifsetup.jpg\" />\n\n「Submit」ボタンを押します。自動的にカメラを検索しようとします。成功した場合は、 \nリストからカメラを選択し、空白のフィールドを入力します。 \nそれ以外の場合は、すべてのフィールドを手動で入力する必要があります。次のウィンドウが表示されます。\n\n <robo-wiki-picture src=\"home-assistant/onvifconfig.jpg\" />\n\n空白を埋める:\n- Name - カメラに名前を付ける\n- Host - カメラのIPアドレスを入力する\n- Port - ほとんどの場合、2020年ですが、カメラの提供元によっては変更される場合があります\n- Username - カメラのローカルアカウントのユーザー名を入力する\n  - Password - カメラのローカルアカウントのパスワードを入力する\n\nそして、「Submit」を押します。カメラのエリアを選択し、「Finish」をクリックします。\n\n## ダッシュボードにカメラ制御を追加する\n\nカメラの設定が完了したので、ストリームと制御ボタンをダッシュボードに追加できます。\n\nダッシュードに移動し、新しいカードを作成します。「Picture Glance」を選択します。\n\n <robo-wiki-picture src=\"home-assistant/glance.jpg\" />\n\nデータを入力します:\n- Title - カメラ画像のタイトルを選択します\n- Camera Entity - ドロップダウンリストからカメラエンティティを選択します\n- Camera View - 遅延を少なくするために「live」を選択します\n\n次に、左下のボタンを押して「Code Editor」モードに切り替えます。次のコードが表示されます。\n```shell\ncamera_view: live\ntype: picture-glance\ntitle: Kitchen\nimage: https://demo.home-assistant.io/stub_config/kitchen.png\nentities: []\ncamera_image: camera.tapo_mainstream\n```\n\n`entities: []`の内容を以下の例に従って置き換えます（`<YOUR_CAMERA_ENTITY>`は`camera_image`パラメータと同じです）:\n\n<code-helper copy>\n\n```\nentities:\n  - entity: <YOUR_CAMERA_ENTITY>\n    tap_action:\n      action: call-service\n      service: onvif.ptz\n      service_data:\n        entity_id: <YOUR_CAMERA_ENTITY>\n        pan: LEFT\n        speed: 1\n        distance: 0.3\n        move_mode: ContinuousMove\n    name: Pan Left\n    show_state: false\n    icon: 'mdi:arrow-left'\n    show_icon: true\n  - entity: <YOUR_CAMERA_ENTITY>\n    tap_action:\n      action: call-service\n      service: onvif.ptz\n      service_data:\n        entity_id: <YOUR_CAMERA_ENTITY>\n        tilt: UP\n        speed: 1\n        distance: 0.3\n        move_mode: ContinuousMove\n    name: Tilt Up\n    icon: 'mdi:arrow-up'\n  - entity: <YOUR_CAMERA_ENTITY>\n    tap_action:\n      action: call-service\n      service: onvif.ptz\n      service_data:\n        entity_id: <YOUR_CAMERA_ENTITY>\n        tilt: DOWN\n        speed: 1\n        distance: 0.3\n        move_mode: ContinuousMove\n    name: Tilt Down\n    icon: 'mdi:arrow-down'\n  - entity: <YOUR_CAMERA_ENTITY>\n    tap_action:\n      action: call-service\n      service: onvif.ptz\n      service_data:\n        entity_id: <YOUR_CAMERA_ENTITY>\n        pan: RIGHT\n        speed: 1\n        distance: 0.3\n        move_mode: ContinuousMove\n    name: Pan Right\n    icon: 'mdi:arrow-right'\n    show_icon: true\n```\n\n</code-helper>\n\n以上です。ダッシュボードにPTZカメラカードと制御ボタンが表示されるはずです.\n\n## トラブルシューティング\nHome Assistant Coreを使用しており、カメラからのストリームが表示されない場合は、「stream」と「FFMPEG」の統合をインストールする必要があります。 \nこれを行うには、`stream: `と`ffmpeg: `の文字列をconfiguration.yamlの末尾に追加する必要があります。","tools":[],"fileInfo":{"path":"ja/ptz-camera.md","name":"ptz-camera"}}},"context":{}}