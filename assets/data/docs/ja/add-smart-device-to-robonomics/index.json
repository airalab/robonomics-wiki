{"hash":"e655f604bb2f2c0db373b92e3c90831c4970a1fc","data":{"doc":{"id":"bfb44d68b0e67e6d1966d8931e35a0be","title":"Add Robonomics Integration","contributors":["LoSk-p"],"translated":false,"headings":[],"subtitles":[{"depth":2,"value":"Add custom integration","anchor":"#add-custom-integration"},{"depth":2,"value":"Configure","anchor":"#configure"},{"depth":2,"value":"Use DApp","anchor":"#use-dapp"},{"depth":3,"value":"See data","anchor":"#see-data"},{"depth":3,"value":"Control device","anchor":"#control-device"}],"content":"\nIntegration allow Home Assistant to record datalogs with encrypted data from Home Assistant and listen launch commands to control smart devices. Integration use IPFS to store data and send IPFS hash in datalog or launch.\n\n## Add custom integration\n\nOn your raspberry pi with Home Assistant log in homeassistant user:\n```bash \nsudo -u homeassistant -H -s\n```\nAnd install python package:\n```bash\nsource /srv/homeassistant/bin/activate\npip install http3\n```\n\nThen go to `.homeassistant` directory:\n```bash\ncd /home/homeassistant/.homeassistant\n```\nCreate directory `custom_components` and clone there the repository with the integration:\n\n```bash\nmkdir custom_components\ncd custom_components\ngit clone https://github.com/LoSk-p/robonomics_smart_home.git\n```\n\nThen you need to install IPFS node to your raspberry. For that use `install_ipfs.sh` script:\n\n```bash\nsu ubuntu\ncd ~\nwget https://raw.githubusercontent.com/LoSk-p/robonomics_smart_home/main/install_ipfs.sh\nsudo chmod +x install_ipfs.sh\n./install_ipfs.sh\n```\n\n## Configure\n\nNow you can add integration to Home Assistant. First, restart it:\n\n```bash\nsystemctl restart home-assistant@homeassistant.service\n```\nThen in web interface go to `Settings/Device & Services` and press `Add Integration`. Find there `Robonomics`:\n\n![integration](/docs/images/home-assistant/add-integration.png)\n\nClick on it and fill the configuration. Here you need to add seed from `SUB_ADMIN` snd `SUB_OWNER` accounts and check the boxes if you created accounts with ED25519 type (it is better if you did that). Also you can set sending interval, by default it is 10 minutes.\n\nMoreover, you can add your Pinata credentials. It is not nessessary, if you will not do it, data will be pinned with your local node and Infura. If you add it, files also will be pinned in Pinata, it may help to faster access it.\n\n![configuration](/docs/images/home-assistant/configuration.png)\n\n## Use DApp\n\nNow you can use [Smarthome DApp](https://vol4tim.github.io/account-manager/#/) to control your home through the Robonomics. Both accounts `SUB_ADMIN` and `SUB_OWNER` must be added to the [Polcadot extention](https://polkadot.js.org/extension/).\n\nIn `Account` field choose your account with subscription. In the picture account `4FzqML6URZ5KWtk5MoQmrykkaRNvVuzYEGva77ytG1XA3Hus` is `SUB_ADMIN` (to read telemetry mark a ster on it):\n![dapp-start](/docs/images/home-assistant/dapp-start.png)\n\n### See data\n\nNow we can se the data from our home. Press on `SUB_ADMIN` account and you will see list of datalogs:\n\n![dapp-datalog](/docs/images/home-assistant/dapp-datalog.png)\n\nPress `read` on the last datalog and wait while IPFS file is reading. After that write your secret key or mnemonic seed from `SUB_ADMIN` account and press decrypt. You will see the data:\n\n![dapp-data](/docs/images/home-assistant/dapp-data.png)\n\n### Control device\n\nTo control devices go back to main page and press send button near `SUB_ADMIN` account. Here you can control any controllable device from Home Assistant. You need to know its entity id and and the service you want to call. Entity ids you can find in Home Assistant in `Settings/Devices & Services/Entities` and service `Developer Tool/Services`. The platform is the part of entity id before the dot. For example lets turn off shapes, it has entity id `light.shapes_9275`, so the platform is `light` and we can use service `turn_off`.\n\n![dapp-command](/docs/images/home-assistant/dapp-command.png)\n\nYou can send encrypted command or not encrypted. To send encryptrd command just tick `crypto` before send message and write you secret key from sending account."}},"context":{}}