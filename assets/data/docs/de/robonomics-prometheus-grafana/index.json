{"hash":"dde37335f94693e5e93177d1e4e5fb502f1d4f29","data":{"doc":{"id":"4ad5fb9398a0306a88fcfb1f40323cf4","title":"Robonomics + Prometheus + Grafana","description":"","contributors":["Vourhey"],"headings":[],"subtitles":[{"depth":2,"value":"Einführung","anchor":"#einführung"},{"depth":2,"value":"Voraussetzungen","anchor":"#voraussetzungen"},{"depth":2,"value":"Schritt 1 - Erstellen von Service-Benutzern","anchor":"#schritt-1---erstellen-von-service-benutzern"},{"depth":2,"value":"Schritt 2 - Herunterladen von Prometheus","anchor":"#schritt-2---herunterladen-von-prometheus"},{"depth":2,"value":"Schritt 3 - Konfigurieren von Prometheus","anchor":"#schritt-3---konfigurieren-von-prometheus"},{"depth":2,"value":"Schritt 4 - Prometheus ausführen","anchor":"#schritt-4---prometheus-ausführen"},{"depth":2,"value":"Schritt 5 - Herunterladen des Node Exporters","anchor":"#schritt-5---herunterladen-des-node-exporters"},{"depth":2,"value":"Schritt 6 - Ausführen des Node Exporters","anchor":"#schritt-6---ausführen-des-node-exporters"},{"depth":2,"value":"Schritt 7 - Konfigurieren von Prometheus zum Abrufen von Node Exporter","anchor":"#schritt-7---konfigurieren-von-prometheus-zum-abrufen-von-node-exporter"},{"depth":2,"value":"Schritt 8 - Hinzufügen des Robonomic-Builds in node_exporter","anchor":"#schritt-8---hinzufügen-des-robonomic-builds-in-node_exporter"},{"depth":2,"value":"Schritt 9 - Einrichten von Grafana","anchor":"#schritt-9---einrichten-von-grafana"},{"depth":2,"value":"Referenzen","anchor":"#referenzen"}],"content":"\n**Die folgende Anleitung stammt von [Hubo Bubo](https://github.com/hubobubo)**\n\n**Der Originalartikel befindet sich [hier](https://github.com/hubobubo/robonomics/wiki/Robonomics-(XRT)-Metriken-mit-Prometheus-und-Grafana)**\n\n## Einführung\nUm Robonomics-Knoten besser überwachen und warten zu können, ist es ratsam, eine Überwachung auf Basis von Prometheus Server und Grafana einzurichten. Dieses Dokument zeigt, wie Sie jedes einzelne davon konfigurieren können, um Ihren Knoten vollständig zu überwachen.\n\n##  Voraussetzungen\n* [Servereinrichtung mit Ubuntu 18.04](https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04) \n* [Robonomics-Parachain-Collator installiert](https://blog.aira.life/installing-and-running-the-robonomics-validator-in-the-polkadot-network-487ad4c1a567)\n* Stellen Sie sicher, dass robonomics.service auf Ihrem Gerät funktioniert und Port 9615 erreichbar ist. \n\n## Schritt 1 - Erstellen von Service-Benutzern\n\nAus Sicherheitsgründen beginnen wir damit, zwei neue Benutzerkonten, prometheus und node_exporter, zu erstellen. Erstellen Sie diese beiden Benutzer und verwenden Sie die Optionen _--no-create-home_ und _--shell /bin/false_, damit sich diese Benutzer nicht am Server anmelden können.\n```\nsudo useradd --no-create-home --shell /bin/false prometheus\nsudo useradd --no-create-home --shell /bin/false node_exporter\n```\n\nBevor wir die Prometheus-Binärdateien herunterladen, erstellen wir die erforderlichen Verzeichnisse zum Speichern der Dateien und Daten von Prometheus. Gemäß den Standardkonventionen von Linux erstellen wir ein Verzeichnis in _/etc_ für die Konfigurationsdateien von Prometheus und ein Verzeichnis in _/var/lib_ für seine Daten.\n```\nsudo mkdir /etc/prometheus\nsudo mkdir /var/lib/prometheus\n```\nLegen Sie nun den Benutzer- und Gruppenbesitz auf den neuen Verzeichnissen auf den Benutzer prometheus fest.\n```\nsudo chown prometheus:prometheus /etc/prometheus\nsudo chown prometheus:prometheus /var/lib/prometheus\n```\n## Schritt 2 - Herunterladen von Prometheus\n\nLaden Sie zunächst die aktuelle stabile Version von Prometheus herunter und entpacken Sie sie in Ihr Home-Verzeichnis. Die neuesten Binärdateien finden Sie auf der [Prometheus-Downloadseite.](https://prometheus.io/download/)\n\n```\nwget https://github.com/prometheus/prometheus/releases/download/v2.21.0/prometheus-2.21.0.linux-amd64.tar.gz\n\n```\nEntpacken Sie nun das heruntergeladene Archiv.\n\n```\ntar xvf prometheus-2.21.0.linux-amd64.tar.gz\n\n```\nDies erstellt ein Verzeichnis namens prometheus-2.21.0.linux-amd64, das zwei Binärdateien (prometheus und promtool), die Verzeichnisse _consoles_ und _console_libraries_ mit den Dateien der Web-Benutzeroberfläche, eine Lizenz, einen Hinweis und mehrere Beispieldateien enthält.\n\nKopieren Sie die beiden Binärdateien in das Verzeichnis _/usr/local/bin_.\n\n```\nsudo cp prometheus-2.21.0.linux-amd64/prometheus /usr/local/bin/\nsudo cp prometheus-2.21.0.linux-amd64/promtool /usr/local/bin/\n\n```\nLegen Sie den Benutzer- und Gruppenbesitz auf den Binärdateien auf den in Schritt 1 erstellten Benutzer prometheus fest.\n\n```\nsudo chown prometheus:prometheus /usr/local/bin/prometheus\nsudo chown prometheus:prometheus /usr/local/bin/promtool\n\n```\nKopieren Sie die Verzeichnisse consoles und _console_libraries_ nach _/etc/prometheus_.\n\n```\nsudo cp -r prometheus-2.21.0.linux-amd64/consoles /etc/prometheus\nsudo cp -r prometheus-2.21.0.linux-amd64/console_libraries /etc/prometheus\n\n```\nLegen Sie den Benutzer- und Gruppenbesitz auf den Verzeichnissen auf den Benutzer prometheus fest. Mit der Option -R wird sichergestellt, dass der Besitz auch auf die Dateien innerhalb des Verzeichnisses angewendet wird.\n\n```\nsudo chown -R prometheus:prometheus /etc/prometheus/consoles\nsudo chown -R prometheus:prometheus /etc/prometheus/console_libraries\n\n```\nJetzt, da Prometheus installiert ist, erstellen wir seine Konfigurations- und Service-Dateien zur Vorbereitung des ersten Starts.\n\n## Schritt 3 - Konfigurieren von Prometheus\n\nErstellen Sie im Verzeichnis _/etc/prometheus_ mit nano oder Ihrem bevorzugten Texteditor eine Konfigurationsdatei namens _prometheus.yml_.\n\n```\nsudo nano /etc/prometheus/prometheus.yml\n\n```\nDefinieren Sie in den globalen Einstellungen das Standardintervall zum Abrufen von Metriken. Beachten Sie, dass Prometheus diese Einstellungen auf jeden Exporter anwendet, es sei denn, die eigenen Einstellungen des Exporters überschreiben die globalen Einstellungen.\n\n```\nglobal:\n  scrape_interval: 15s\n\n```\nDieser Wert für scrape_interval gibt an, dass Prometheus Metriken von seinen Exportern alle 15 Sekunden sammeln soll, was für die meisten Exporter ausreichend ist.\nFügen Sie nun Prometheus selbst zur Liste der Exporter hinzu, von denen gescraped werden soll, mit der folgenden scrape_configs-Anweisung:\n\n```\n...\nscrape_configs:\n  - job_name: 'prometheus'\n    scrape_interval: 5s\n    static_configs:\n      - targets: ['localhost:9090']\n```\nPrometheus verwendet den _job_name_, um Exporter in Abfragen und auf Diagrammen zu kennzeichnen. Stellen Sie also sicher, dass Sie hier etwas Beschreibendes auswählen.\n\nUnd da Prometheus wichtige Daten über sich selbst exportiert, die Sie zur Überwachung der Leistung und zur Fehlerbehebung verwenden können, haben wir die globale scrape_interval-Direktive von 15 Sekunden auf 5 Sekunden überschrieben, um häufigere Aktualisierungen zu ermöglichen.\n\nSchließlich verwendet Prometheus die Direktiven _static_configs_ und _targets_, um festzustellen, wo Exporter ausgeführt werden. Da dieser Exporter auf demselben Server wie Prometheus selbst läuft, können wir localhost anstelle einer IP-Adresse zusammen mit dem Standardport 9090 verwenden.\n\nIhre Konfigurationsdatei sollte jetzt wie folgt aussehen:\n\n```\nglobal:\n  scrape_interval: 15s\n\nscrape_configs:\n  - job_name: 'prometheus'\n    scrape_interval: 5s\n    static_configs:\n      - targets: ['localhost:9090']\n```\nSpeichern Sie die Datei und beenden Sie Ihren Texteditor.\n\nLegen Sie nun die Benutzer- und Gruppenbesitzrechte für die Konfigurationsdatei auf den in Schritt 1 erstellten prometheus-Benutzer fest.\n\n```\nsudo chown prometheus:prometheus /etc/prometheus/prometheus.yml\n\n```\nMit der Konfiguration abgeschlossen sind wir bereit, Prometheus zum ersten Mal auszuführen.\n\n## Schritt 4 - Prometheus ausführen\n\nStarten Sie Prometheus als Benutzer _prometheus_ und geben Sie den Pfad zur Konfigurationsdatei und zum Datenverzeichnis an.\n\n```\nsudo -u prometheus /usr/local/bin/prometheus \\\n    --config.file /etc/prometheus/prometheus.yml \\\n    --storage.tsdb.path /var/lib/prometheus/ \\\n    --web.console.templates=/etc/prometheus/consoles \\\n    --web.console.libraries=/etc/prometheus/console_libraries\n```\n\nDie Ausgabe enthält Informationen zum Ladevorgang von Prometheus, zur Konfigurationsdatei und zu verwandten Diensten. Sie bestätigt auch, dass Prometheus auf Port _9090_ lauscht.\n\n```\n_log output_\nSep 14 17:55:53 robonomics systemd[1]: Started Prometheus.\nSep 14 17:55:53 robonomics prometheus[29488]: level=info ts=2020-09-14T15:55:53.347Z caller=main.go:310 msg=\"No time or size retention was set so using the default time retention\" duration=15d\nSep 14 17:55:53 robonomics prometheus[29488]: level=info ts=2020-09-14T15:55:53.350Z caller=main.go:346 msg=\"Starting Prometheus\" version=\"(version=2.21.0, branch=HEAD, revision=e83ef207b6c2398919b69cd87d2693cfc2fb4127)\"\nSep 14 17:55:53 robonomics prometheus[29488]: level=info ts=2020-09-14T15:55:53.351Z caller=main.go:347 build_context=\"(go=go1.15.2, user=root@a4d9bea8479e, date=20200911-11:35:02)\"\nSep 14 17:55:53 robonomics prometheus[29488]: level=info ts=2020-09-14T15:55:53.351Z caller=main.go:348 host_details=\"(Linux 4.15.0-112-generic #113-Ubuntu SMP Thu Jul 9 23:41:39 UTC 2020 x86_64 robonomics (none))\"\nSep 14 17:55:53 robonomics prometheus[29488]: level=info ts=2020-09-14T15:55:53.351Z caller=main.go:349 fd_limits=\"(soft=1024, hard=4096)\"\nSep 14 17:55:53 robonomics prometheus[29488]: level=info ts=2020-09-14T15:55:53.351Z caller=main.go:350 vm_limits=\"(soft=unlimited, hard=unlimited)\"\nSep 14 17:55:53 robonomics prometheus[29488]: level=info ts=2020-09-14T15:55:53.357Z caller=main.go:701 msg=\"Starting TSDB ...\"\nSep 14 17:55:53 robonomics prometheus[29488]: level=info ts=2020-09-14T15:55:53.368Z caller=web.go:523 component=web msg=\"Start listening for connections\" address=0.0.0.0:9090\nSep 14 17:55:53 robonomics prometheus[29488]: level=info ts=2020-09-14T15:55:53.372Z caller=head.go:644 component=tsdb msg=\"Replaying on-disk memory mappable chunks if any\"\nSep 14 17:55:53 robonomics prometheus[29488]: level=info ts=2020-09-14T15:55:53.373Z caller=head.go:658 component=tsdb msg=\"On-disk memory mappable chunks replay completed\" duration=12.659µs\nSep 14 17:55:53 robonomics prometheus[29488]: level=info ts=2020-09-14T15:55:53.373Z caller=head.go:664 component=tsdb msg=\"Replaying WAL, this may take a while\"\nSep 14 17:55:53 robonomics prometheus[29488]: level=info ts=2020-09-14T15:55:53.380Z caller=head.go:716 component=tsdb msg=\"WAL segment loaded\" segment=0 maxSegment=1\nSep 14 17:55:53 robonomics prometheus[29488]: level=info ts=2020-09-14T15:55:53.381Z caller=head.go:716 component=tsdb msg=\"WAL segment loaded\" segment=1 maxSegment=1\nSep 14 17:55:53 robonomics prometheus[29488]: level=info ts=2020-09-14T15:55:53.381Z caller=head.go:719 component=tsdb msg=\"WAL replay completed\" checkpoint_replay_duration=48.125µs wal_replay_duration=8.253748ms total_replay_duration=8.343335ms\nSep 14 17:55:53 robonomics prometheus[29488]: level=info ts=2020-09-14T15:55:53.383Z caller=main.go:721 fs_type=EXT4_SUPER_MAGIC\nSep 14 17:55:53 robonomics prometheus[29488]: level=info ts=2020-09-14T15:55:53.384Z caller=main.go:724 msg=\"TSDB started\"\nSep 14 17:55:53 robonomics prometheus[29488]: level=info ts=2020-09-14T15:55:53.384Z caller=main.go:850 msg=\"Loading configuration file\" filename=/etc/prometheus/prometheus.yml\nSep 14 17:55:53 robonomics prometheus[29488]: level=info ts=2020-09-14T15:55:53.384Z caller=main.go:881 msg=\"Completed loading of configuration file\" filename=/etc/prometheus/prometheus.yml totalDuration=908.135µs remote_storage=6.693µs web_handler=819ns query_engine=1.383µs scrape=400.232µs scrape_sd=41.679µs notify=1.1µs notify_sd=1.847µs rules=1.522µs\nSep 14 17:55:53 robonomics prometheus[29488]: level=info ts=2020-09-14T15:55:53.384Z caller=main.go:673 msg=\"Server is ready to receive web requests.\"\n```\nWenn Sie eine Fehlermeldung erhalten, überprüfen Sie, ob Sie die YAML-Syntax in Ihrer Konfigurationsdatei verwendet haben, und befolgen Sie dann die Bildschirmanweisungen zur Behebung des Problems.\n\nHalten Sie nun Prometheus an, indem Sie _STRG+C_ drücken, und öffnen Sie dann eine neue _systemd_-Service-Datei.\n\n```\nsudo nano /etc/systemd/system/prometheus.service\n\n```\nDie Service-Datei gibt _systemd_ an, Prometheus als Benutzer prometheus auszuführen, wobei die Konfigurationsdatei im Verzeichnis _/etc/prometheus/prometheus.yml_ und die Daten im Verzeichnis _/var/lib/prometheus_ gespeichert werden sollen. Kopieren Sie den folgenden Inhalt in die Datei:\n\n```\n[Unit]\nDescription=Prometheus\nWants=network-online.target\nAfter=network-online.target\n\n[Service]\nUser=prometheus\nGroup=prometheus\nType=simple\nExecStart=/usr/local/bin/prometheus \\\n    --config.file /etc/prometheus/prometheus.yml \\\n    --storage.tsdb.path /var/lib/prometheus/ \\\n    --web.console.templates=/etc/prometheus/consoles \\\n    --web.console.libraries=/etc/prometheus/console_libraries\n\n[Install]\nWantedBy=multi-user.target\n```\n\nSpeichern Sie die Datei schließlich und schließen Sie Ihren Texteditor. Um den neu erstellten Service zu verwenden, laden Sie systemd neu.\n\n```\nsudo systemctl daemon-reload\n\n```\nSie können Prometheus jetzt mit dem folgenden Befehl starten:\n\n```\nsudo systemctl start prometheus\n\n```\nUm sicherzustellen, dass Prometheus läuft, überprüfen Sie den Status des Dienstes.\n\n```\nsudo systemctl status prometheus\n\n```\nDie Ausgabe gibt Ihnen Informationen über den Status von Prometheus, die Hauptprozesskennung (PID), den Speicherverbrauch und mehr.\n\nWenn der Status des Dienstes nicht aktiv ist, befolgen Sie die Anweisungen auf dem Bildschirm und gehen Sie die vorherigen Schritte erneut durch, um das Problem zu beheben, bevor Sie das Tutorial fortsetzen.\n\n```\n* prometheus.service - Prometheus\n   Loaded: loaded (/etc/systemd/system/prometheus.service; enabled; vendor preset: enabled)\n   Active: active (running) since Mon 2020-09-14 17:59:48 CEST; 24h ago\n Main PID: 29650 (prometheus)\n    Tasks: 9 (limit: 4915)\n   CGroup: /system.slice/prometheus.service\n           `-29650 /usr/local/bin/prometheus --config.file /etc/prometheus/prometheus.yml --storage.tsdb.path /var/lib/prometheus/ --web.console.templates=/etc/prometheus/consoles --web.console.libraries=/etc/prometheus/console_libraries\n```\n\nWenn Sie bereit sind, fahren Sie fort, indem Sie _Q_ drücken, um den Statusbefehl zu beenden. Aktivieren Sie abschließend den Dienst, um beim Start zu starten.\n\n```\nsudo systemctl enable prometheus\n\n```\n\nJetzt, da Prometheus läuft, können wir einen zusätzlichen Exporter installieren, um Metriken über die Ressourcen unseres Servers zu generieren.\n\n## Schritt 5 - Herunterladen des Node Exporters\n\nUm Prometheus über Metriken nur über sich selbst hinaus zu erweitern, installieren wir einen zusätzlichen Exporter namens Node Exporter. Node Exporter liefert detaillierte Informationen über das System, einschließlich CPU-, Festplatten- und Speichernutzung. Laden Sie die aktuelle stabile Version von Node Exporter in Ihr Home-Verzeichnis herunter. Die neuesten Binärdateien finden Sie auf der [Prometheus-Downloadseite.](https://prometheus.io/download/)\n\n```\nwget https://github.com/prometheus/node_exporter/releases/download/v1.0.1/node_exporter-1.0.1.linux-amd64.tar.gz\n\n```\nEntpacken Sie nun das heruntergeladene Archiv.\n\n```\ntar xvf node_exporter-1.0.1.linux-amd64.tar.gz\n\n```\nDadurch wird ein Verzeichnis namens _node_exporter-1.0.1.linux-amd64_ erstellt, das eine Binärdatei namens _node_exporter_, eine Lizenz und einen Hinweis enthält.\n\nKopieren Sie die Binärdatei in das Verzeichnis _/usr/local/bin_ und setzen Sie die Benutzer- und Gruppenbesitzrechte auf den node_exporter-Benutzer, den Sie in Schritt 1 erstellt haben.\n\n```\nsudo cp node_exporter-1.0.1.linux-amd64/node_exporter /usr/local/bin\nsudo chown node_exporter:node_exporter /usr/local/bin/node_exporter\n\n```\nJetzt, da Sie Node Exporter installiert haben, testen wir es, indem wir es ausführen, bevor wir eine Dienstdatei dafür erstellen, damit es beim Starten gestartet wird.\n\n## Schritt 6 - Ausführen des Node Exporters\n\nDie Schritte zum Ausführen des Node Exporters ähneln denen zum Ausführen von Prometheus selbst. Beginnen Sie damit, die Systemd-Dienstdatei für den Node Exporter zu erstellen.\n\n```\nsudo nano /etc/systemd/system/node_exporter.service\n\n```\nKopieren Sie den folgenden Inhalt in die Dienstdatei:\n\n```\n[Unit]\nDescription=Node Exporter\nWants=network-online.target\nAfter=network-online.target\n\n[Service]\nUser=node_exporter\nGroup=node_exporter\nType=simple\nExecStart=/usr/local/bin/node_exporter --collector.systemd\n\n[Install]\nWantedBy=multi-user.target\n```\n\nSpeichern Sie die Datei und schließen Sie Ihren Texteditor. Aktualisieren Sie schließlich systemd, um den neu erstellten Dienst zu verwenden.\n\n```\nsudo systemctl daemon-reload\n\n```\nSie können Node Exporter jetzt mit dem folgenden Befehl ausführen:\n\n```\nsudo systemctl start node_exporter\n\n```\nÜberprüfen that Node Exporter’s running correctly with the status command.\n\n```\nsudo systemctl status node_exporter\n\n```\nWie zuvor gibt Ihnen diese Ausgabe Informationen über den Status von Node Exporter, die Hauptprozess-ID (PID), den Speicherverbrauch und mehr. Wenn der Status des Dienstes nicht aktiv ist, folgen Sie den Bildschirmanweisungen und gehen Sie die vorherigen Schritte erneut durch, um das Problem zu beheben, bevor Sie fortfahren.\n\n```\n_Output_\n* node_exporter.service - Node Exporter\n   Loaded: loaded (/etc/systemd/system/node_exporter.service; enabled; vendor preset: enabled)\n   Active: active (running) since Mon 2020-09-14 17:58:25 CEST; 1 day 1h ago\n Main PID: 29612 (node_exporter)\n    Tasks: 7 (limit: 4915)\n   CGroup: /system.slice/node_exporter.service\n           `-29612 /usr/local/bin/node_exporter --collector.systemd\n```\nSchließlich aktivieren Sie Node Exporter, um beim Start zu starten.\n\n```\nsudo systemctl enable node_exporter\n\n```\nNachdem Node Exporter vollständig konfiguriert und wie erwartet ausgeführt wird, teilen wir Prometheus mit, dass es die neuen Metriken abrufen soll.\n\n## Schritt 7 - Konfigurieren von Prometheus zum Abrufen von Node Exporter\n\nDa Prometheus nur Exporter abruft, die in der scrape_configs-Sektion seiner Konfigurationsdatei definiert sind, müssen wir einen Eintrag für Node Exporter hinzufügen, genau wie wir es für Prometheus selbst getan haben. Öffnen Sie die Konfigurationsdatei.\n\n```\nsudo nano /etc/prometheus/prometheus.yml\n\n```\nFügen Sie am Ende des scrape_configs-Blocks einen neuen Eintrag namens node_exporter hinzu.\n\n```\n...\n  - job_name: 'node_exporter'\n    scrape_interval: 5s\n    static_configs:\n      - targets: ['localhost:9100']\n```\nDa dieser Exporter auch auf demselben Server wie Prometheus selbst läuft, können wir erneut localhost anstelle einer IP-Adresse verwenden, zusammen mit dem Standardport von Node Exporter, 9100. Ihre gesamte Konfigurationsdatei sollte wie folgt aussehen:\n\n```\nglobal:\n  scrape_interval: 15s\n\nscrape_configs:\n  - job_name: 'prometheus'\n    scrape_interval: 5s\n    static_configs:\n      - targets: ['localhost:9090']\n  - job_name: 'node_exporter'\n    scrape_interval: 5s\n    static_configs:\n      - targets: ['localhost:9100']\n```\nSpeichern Sie die Datei und beenden Sie Ihren Texteditor, wenn Sie bereit sind, fortzufahren. Starten Sie schließlich Prometheus neu, um die Änderungen wirksam zu machen.\n\n```\nsudo systemctl restart prometheus\n\n```\nÜberprüfen Sie erneut mit dem Befehl status, ob alles korrekt ausgeführt wird.\n\n```\nsudo systemctl status prometheus\n\n```\nWenn der Status des Dienstes nicht auf aktiv gesetzt ist, folgen Sie den Bildschirmanweisungen und gehen Sie Ihre vorherigen Schritte erneut durch, bevor Sie fortfahren.\n\n```\nOutput\n* prometheus.service - Prometheus\n   Loaded: loaded (/etc/systemd/system/prometheus.service; enabled; vendor preset: enabled)\n   Active: active (running) since Tue 2020-09-15 19:06:56 CEST; 2s ago\n Main PID: 19725 (prometheus)\n    Tasks: 8 (limit: 4915)\n   CGroup: /system.slice/prometheus.service\n           `-19725 /usr/local/bin/prometheus --config.file /etc/prometheus/prometheus.yml --storage.tsdb.path /var/lib/prometheus/ --web.console.templates=/etc/prometheus/consoles --web.console.libraries=/etc/prometheus/console_libraries\n```\n\nWir haben jetzt Prometheus und Node Exporter installiert, konfiguriert und laufen lassen.\n\n## Schritt 8 - Hinzufügen des Robonomic-Builds in node_exporter\n\nNach erfolgreicher Installation von Prometheus und node_exporter müssen wir den integrierten Prometheus-Exporter in jedem Substratprojekt verwenden. Um dies zu erreichen, müssen wir einen zusätzlichen Eintrag zu _/etc/prometheus/prometheus.yml_ hinzufügen.. \nÖffnen Sie die Konfigurationsdatei.\n\n```\nsudo nano /etc/prometheus/prometheus.yml\n\n```\nFügen Sie am Ende des scrape_configs-Blocks einen neuen Eintrag namens robonomic_exporter hinzu.\n\n``` \n  - job_name: 'robonomics_exporter'\n    scrape_interval: 5s\n    static_configs:\n      - targets: ['localhost:9615']\n```\nSpeichern Sie die Datei und beenden Sie Ihren Texteditor. Ihre gesamte Konfigurationsdatei sollte wie folgt aussehen:\n\n```\nglobal:\n  scrape_interval: 15s\n\nscrape_configs:\n  - job_name: 'prometheus'\n    scrape_interval: 5s\n    static_configs:\n      - targets: ['localhost:9090']\n  - job_name: 'node_exporter'\n    scrape_interval: 5s\n    static_configs:\n      - targets: ['localhost:9100']\n  - job_name: 'robonomics_exporter'\n    scrape_interval: 5s\n    static_configs:\n      - targets: ['localhost:9615']\n```\n\nStarten Sie schließlich Prometheus neu, um die Änderungen wirksam zu machen.\n\n```\nsudo systemctl restart prometheus\n\n```\nÜberprüfen Sie noch einmal mit dem Statusbefehl, ob alles korrekt läuft.\n\n```\nsudo systemctl status prometheus\n\n```\nWir haben jetzt _Prometheus_ und _Node Exporter_ sowie _Robonomic Exporter_ installiert, konfiguriert und laufen. Gehen Sie nun zu Grafana\n\n## Schritt 9 - Einrichten von Grafana\n\nDer letzte Schritt besteht darin, Prometheus als Datenquelle in Grafana zu verbinden. Für dieses Tutorial verwenden wir eine kostenlose Cloud-basierte Grafana, die bis zu 5 Dashboards sowie ein dediziertes [Robonomics-Dashboard](https://grafana.com/grafana/dashboards/13015) ermöglicht. Gehen Sie einfach zu [grafana.com](https://grafana.com/), erstellen Sie ein neues Konto und melden Sie sich bei Ihrer neu erstellten Grafana-Instanz an.\n\nZu Beginn müssen wir Grafana eine neue _**Datenquelle**_ hinzufügen, die in unserem Fall der Prometheus-Server sein wird.\nGehen Sie zu Datenquelle:\n\n>![DataSource](../images/prometheus-grafana/grafana-6-2020-09-15-19-18-50-Window.png)\n\nKlicken Sie dann auf **_Datenquelle hinzufügen_**\n\n>![DataSource](../images/prometheus-grafana/grafana-7-2020-09-15-19-18-50-Window.png)\n\nNext auswählen _**Prometheus**_\n\n>![DataSource](../images/prometheus-grafana/grafana-8-2020-09-15-19-18-50-Window.png)\n\nGeben Sie im neuen Bildschirm Ihre **_Prometheus-Server-IP-Adresse mit Port 9090_** ein\n\n> ![DataSource](../images/prometheus-grafana/grafana-9-2020-09-15-19-18-50-Window.png)\n\nDanach _**Speichern & Testen**_, wenn Sie alle Schritte durchgeführt haben, sollte alles grün sein und bereit sein, das Dashboard zu importieren. Klicken Sie auf der Hauptseite auf **+** und dann auf **Importieren**, wie im Bild unten gezeigt:\n\n> ![Import dashboard](../images/prometheus-grafana/grafana-1-2020-09-15-19-18-50-Window.png)\n\nDann sollten Sie die Importseite sehen:\n\n> ![Import page](../images/prometheus-grafana/grafana-2-2020-09-15-19-18-50-Window.png)\n\nGeben Sie in der _Grafana.com Dashboard-URL oder ID_ _**13015**_ ein (da dies die ID des Robonomic-Dashboards ist)\n\n> ![Import Robonomic dashboard](../images/prometheus-grafana/grafana-3-2020-09-15-19-18-50-Window.png)\n\nNach dem Laden des externen Dashboards erhalten Sie diesen Bildschirm:\n\n> ![XRT 13015 dashboard import](../images/prometheus-grafana/grafana-4-2020-09-15-19-18-50-Window.png)\n\nDer letzte Schritt besteht darin, die zuvor erstellte **_Datenquelle_** auszuwählen und auf _**Importieren**_ zu klicken\n\n> ![Prometheus as a DataSource](../images/prometheus-grafana/grafana-5-2020-09-15-19-18-50-Window.png)\n\nDAS IST ES! An diesem Punkt sollten Sie das importierte Dashboard sehen. \n\n\n## Referenzen\n\n* [Anleitung zur Installation von Prometheus auf Ubuntu 16.04](https://www.digitalocean.com/community/tutorials/how-to-install-prometheus-on-ubuntu-16-04)\n* [Erstellen eines Überwachungsdashboards mit Prometheus + Grafana](https://medium.com/htc-research-engineering-blog/build-a-monitoring-dashboard-by-prometheus-grafana-741a7d949ec2)\n* [Grafana-Unterstützung für Prometheus](https://prometheus.io/docs/visualization/grafana/)\n* [Überwachung von Linux-Hostmetriken mit dem Node Exporter](https://prometheus.io/docs/guides/node-exporter/)\n* [Abfragen von Prometheus](https://prometheus.io/docs/prometheus/latest/querying/basics/)\n* [Visualisierung von Knotenmetriken](https://substrate.dev/docs/en/tutorials/visualize-node-metrics/)\n* [Substrate Prometheus Exporter](https://github.com/paritytech/substrate/tree/master/utils/prometheus)\n* [polkadot-dashboard](https://github.com/w3f/polkadot-dashboard)\n* [Polkadot-Knotenmetrik](https://grafana.com/grafana/dashboards/12425)\n* [Node Exporter für Prometheus Dashboard](https://grafana.com/grafana/dashboards/11074)\n* [Grafana ROBONOMICS (XRT) Metriken](https://grafana.com/grafana/dashboards/13015)\n\n","tools":[],"fileInfo":{"path":"de/robonomics-prometheus-grafana.md","name":"robonomics-prometheus-grafana"}}},"context":{}}