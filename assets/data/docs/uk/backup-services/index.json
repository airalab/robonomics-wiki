{"hash":"b019132cdf18eb9f78219b0565b919b16f679c3f","data":{"doc":{"id":"5b7c465daf9b5f492518edf25c2c7be1","title":"Сервіси резервного копіювання","description":"","contributors":["tubleronchik","LoSk-p"],"headings":[],"subtitles":[{"depth":2,"value":"Створення резервної копії конфігурації Home Assistant","anchor":"#створення-резервної-копії-конфігурації-home-assistant"},{"depth":2,"value":"Відновлення конфігурації Home Assistant з резервної копії","anchor":"#відновлення-конфігурації-home-assistant-з-резервної-копії"},{"depth":2,"value":"Відновлення конфігурації Mosquitto та Zigbee2MQTT для методу встановлення Home Assistant Core","anchor":"#відновлення-конфігурації-mosquitto-та-zigbee2mqtt-для-методу-встановлення-home-assistant-core"},{"depth":2,"value":"Резервне копіювання конфігурації Mosquitto та Zigbee2MQTT для методу встановлення Home Assistant Docker","anchor":"#резервне-копіювання-конфігурації-mosquitto-та-zigbee2mqtt-для-методу-встановлення-home-assistant-docker"},{"depth":2,"value":"Кнопки резервного копіювання","anchor":"#кнопки-резервного-копіювання"}],"content":"\n**У цій статті ви дізнаєтеся, як створити резервні копії конфігурації вашого Home Assistant та відновити її за потреби. Для створення резервних копій виклиається служба, яка генерує захищений архів з файлами конфігурації. Також служба додає конфігурацію Mosquitto brocker та Zigbee2MQTT до резервної копії, якщо вона існує. Потім цей архів додається до IPFS та отриманий CID зберігається в Robonomics Digital Twв.**\n## Створення резервної копії конфігурації Home Assistant\n\nСтворення резервної копії дозволяє легко відновити конфігурацію Home Assistant у разі виникнення неполадок.\n\n<robo-wiki-video autoplay loop controls :videos=\"[{src: 'QmZN5LfWR4XwAiZ3jEcw7xbCnT81NsF5XE3XFaNhMm5ba1', type:'mp4'}]\" />\n\n<robo-wiki-note type=\"warnвg\" title=\"ПОПЕРЕДЖЕННЯ\">\n\nДля резервного копіювання та відновлення конфігурації необхідно використовувати **власний IPFS-шлюз** такий як Pinata. Без нього ваша резервна копія буде зберігатися лише на вашому локальному вузлі IPFS, що може запобігти відновленню конфігурації Home Assistant у разі відмови локального вузла.\n\n</robo-wiki-note>\n\n1. У веб-інтерфейсі Home Assistant перейдіть до `Developer Tools` -> `Services`. Пошук `Robonomics: Save Backup to Robonomics` та натисніть `CALL SERVICE`.\n\n2. Зачекайте, поки з'явиться повідомлення `Backup was updated in Robonomics` з'явиться в `Notification`.\n\n<robo-wiki-note type=\"warning\" title=\"ПОПЕРЕДЖЕННЯ\">\n\nНе намагайтеся створити резервну копію або відновити конфігурацію безпосередньо після завантаження Home Assistant та Robonomics Integration. Будь ласка, **зачекайте приблизно 5 хвилин** щоб завершити початкову настройку.\n\n</robo-wiki-note>\n\nАргументи служби:\n- **Повна резервна копія**  (default: False) - додає базу даних до резервної копії, тому історія станів сутностей також буде збережена.\n- **Шлях до файлу паролю mosquitto** (default: `/etc/mosquitto`) - Якщо ви використовували методи установки Home Assistant Core або Docker і не маєте типового шляху до Mosquitto brocker, вам слід змінити цей параметр. *Не потрібно для Home Assistant OS або Superviser*.\n\n## Відновлення конфігурації Home Assistant з резервної копії\n\nДля відновлення конфігурації вам потрібно мати встановлений Home Assistant та Robonomics Integration. \n\n<robo-wiki-video autoplay loop controls :videos=\"[{src: 'QmNcJpHWWuZzwNCQryTw5kcki49oNTjEb8xvnfffSYfRVa', type:'mp4'}]\" />\n\n<robo-wiki-note type=\"warning\" title=\"ПОПЕРЕДЖЕННЯ\">\n\nЩоб успішно відновити конфігурацію в методах установки Home Assistant Core та Docker, вам потрібно виконати додаткові кроки налаштування, як описано в кінці сторінки.\n\n</robo-wiki-note>\n\n1. Встановіть Home Assisntant з Robonomics Integration (якщо він ще не встановлений), дотримуючись кроків з статті для [бажаного методу установки](https://wiki.robonomics.network/docs/robonomics-smart-home-overview/#start-тут-your-smart-home).\n\n2. [Налаштування інтеграції Robonomics](https://wiki.robonomics.network/docs/robonomics-hass-integration) за допомогою **тех же насіння** яке ви використовували в попередній конфігурації Robonomics. Якщо ваша підписка закінчилася, [переактивуйте її](https://wiki.robonomics.network/docs/sub-activate).\n\n3. У веб-інтерфейсі Home Assistant перейдіть до `Developer Tools` -> `Services`. Пошук `Robonomics: Restore from the Backup in Robonomics` і а потім у спливаючому вікні дозвольте розширенню це зробити. `CALL SERVICE`. Перейдіть на `Overview` сторінку, щоб перевірити стан вашого резервного копіювання.\n\n4. Після відновлення Home Assistant автоматично перезавантажиться. Якщо з якоїсь причини Home Assistant не перезавантажується, ви можете перевірити стан відновлення, спостерігаючи за станом сутності `robonomics.backup` . Якщо статус `restored` ви повинні вручну перезапустити Home Assistant, перейшовши до `Settings` > `System` і натиснувши на кнопку `RESTART`, розташовану в правому верхньому куті.\n\n5. Якщо ваше резервне копіювання включає конфігурацію Zigbee2MQTT або Mosquitto, вам потрібно перезапустити ці служби, щоб увімкнути нову конфігурацію. Ви можете зробити це вручну, перезапустивши служби окремо, або просто перезапустивши комп'ютер Home Assistant, щоб перезапустити всі служби.\n\nАргументи служби:\n- **Шлях до файлу паролю mosquitto** (default: `/etc/mosquitto`) - Якщо ви використовували етоди встановлення Home Assistant Core або Docker і не маєте типового шляху до брокера Mosquitto, вам слід змінити цей параметр. *Не потрібно для Home Assistant OS або Superviser*.\n- **Шлях до конфігурації Zigbee2MQTT**  (default: `/opt/zigbee2mqtt`) - Якщо ви використовували методи встановлення Home Assistant Core або Docker і не маєте типового шляху до Zigbee2MQTT, вам слід змінити цей параметр. *Не потрібно для Home Assistant OS або Superviser*.\n\n## Відновлення конфігурації Mosquitto та Zigbee2MQTT для методу встановлення Home Assistant Core\n\nЯкщо резервна копія містить конфігурацію Mosquitto або Zigbee2MQTT, під час процесу відновлення вони будуть розміщені в типовому шляху або в шляху, вказаному в аргументах. Однак, якщо ви встановили інтеграцію Robonomics в існуючий Home Assistant Core *(не з попередньо встановленого зображення Robonomics)*, the `homeassistant` користувач може не мати доступу до цього шляху.\n\nТому для відновлення конфігурації Mosquitto та Zigbee2MQTT вам потрібно надати необхідні права на читання користувачу `homeassistant`:\n```bash\nsudo chmod a+w /opt/zigbee2mqtt /etc/mosquitto\n```\n\n## Резервне копіювання конфігурації Mosquitto та Zigbee2MQTT для методу встановлення Home Assistant Docker\n\nЩоб зробити резервну копію конфігурацій Mosquitto та Zigbee2MQTT з контейнера Docker, вам потрібно створити томи для їх відповідних конфігурацій. Це можна зробити, запустивши контейнер Home Assistant з додатковими аргументами:\n\n```bash\ndocker run -d \\\n  --name homeassistant \\\n  --privileged \\\n  --restart=unless-stopped \\\n  -e TZ=MY_TIME_ZONE \\\n  -v /PATH_TO_YOUR_CONFIG:/config \\\n  -v /etc/mosquitto:/etc/mosquitto \\\n  -v /etc/mosquitto:/opt/zigbee2mqtt \\\n  --network=host \\\n  ghcr.io/home-assistant/home-assistant:stable\n```\n\nабо внесіть зміни у ваш `compose.yaml` файл:\n\n```yaml\nversion: '3'\nservices:\n  homeassistant:\n    container_name: homeassistant\n    image: \"ghcr.io/home-assistant/home-assistant:stable\"\n    volumes:\n      - /PATH_TO_YOUR_CONFIG:/config\n      - /etc/localtime:/etc/localtime:ro\n      - /etc/mosquitto:/etc/mosquitto\n      - /etc/mosquitto:/opt/zigbee2mqtt\n    restart: unless-stopped\n    privileged: true\n    network_mode: host\n```\n<robo-wiki-note type=\"note\" title=\"Note\">\n\nЗверніть увагу, що типові шляхи для конфігурацій Mosquitto та Zigbee2MQTT - `/etc/mosquitto` і `/opt/zigbee2mqtt`, відповідно. Однак ці шляхи можуть варіюватися залежно від вашої конкретної настройки.\n\n</robo-wiki-note>\n\n## Кнопки резервного копіювання\n\nКрім використання служб для роботи з резервними копіями, ви можете спростити процес, використовуючи `Переконайтеся, що ви підключені до Robonomics Parachain заразcreate_backup` і `Переконайтеся, що ви підключені до Robonomics Parachain заразrestore_from_backup` кнопки з інтеграції Robonomics. Ці кнопки викликають відповідні служби з типовими параметрами (кнопка резервного копіювання створює резервну копію без історії).\n\n<robo-wiki-video autoplay loop controls :videos=\"[{src: 'Qmc1fexYaJMsK6ch6JhjL6aqnAwqYNAzo5nEwYgDpnp4gj', type:'mp4'}]\" />\n\nЩоб додати кнопки на вашу панель інструментів, виконайте наступні кроки:\n\n1. Натисніть на три крапки в правому верхньому куті панелі інструментів.\n2. Виберіть `Edit Dashboard`.\n3. Натисніть на кнопку `Add Card` в правому нижньому куті.\n4. Choose the `Entities` картку.\n5. У полі `Entities` знайдіть сутності Переконайтеся, що ви підключені до Robonomics Parachain заразcreate_backup та button.restore_from_backup.\n6. Натисніть `Save` для додавання сутностей на картку.\n7. Завершіть редагування, натиснувши кнопку `Done` в правому верхньому куті.","tools":["Robonomics Home Assistant Integration 1.4.2 https://github.com/airalab/homeassistant-robonomics-integration"],"fileInfo":{"path":"uk/backup-services.md","name":"backup-services"}}},"context":{}}