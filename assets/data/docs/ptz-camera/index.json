{"hash":"3b6a0731d4a0c8bcdddc9f5428388a7bacfdc2bc","data":{"doc":{"id":"6f9bac97e1e87005049e99935929e129","title":"RTZ camera control in Home Assistant","description":"","contributors":["nakata5321"],"headings":[],"subtitles":[{"depth":2,"value":"ONVIF integration","anchor":"#onvif-integration"},{"depth":2,"value":"Add camera control to the dashboard","anchor":"#add-camera-control-to-the-dashboard"},{"depth":2,"value":"Troubleshooting","anchor":"#troubleshooting"}],"content":"\nThis article covers a process of an RTZ camera set up in Home Assistant. \nONVIF protocol will be used. This requires a local camera account.\n\n<robo-wiki-note type=\"warning\">\nThe process of setting up the local camera account is not covered in this article.\n</robo-wiki-note>\n\nRequirements:\n- RTZ camera\n- Local camera account\n- Camera IP address\n- Configured Home Assistant\n\n## ONVIF integration\n\nLet's start with the installation of **ONVIF integration**. \n\nGo to \"Devices & Services\" in \"Settings\" and press the \"ADD INTEGRATION\" button.\nType \"ONVIF\" and choose the integration. You will see the next window.\n\n <robo-wiki-picture src=\"home-assistant/onvifsetup.jpg\" />\n\nPress the \"Submit\" button. It will try to automatically search for your camera. If succeeded, \nchoose your camera from the list and fill in empty fields. \nOtherwise, you have to fill in all the fields manually. You will see the following window.\n\n <robo-wiki-picture src=\"home-assistant/onvifconfig.jpg\" />\n\nFill in the gaps:\n- Name - give a name to your camera\n- Host - provide The IP address of your camera\n- Port - mostly common it's 2020, but your camera provider may change it\n- Username - write a username of your camera local account\n  - Password - write a password for your camera local account\n\nand press \"Submit\". Choose an Area for your camera and click on \"Finish\".\n\n## Add camera control to the dashboard\n\nNow that you have fully set up the camera, you may add its stream and control buttons to the dashboard.\n\nGo to the dashboard and start with creating a new card. Choose the \"Picture Glance\" one.\n\n <robo-wiki-picture src=\"home-assistant/glance.jpg\" />\n\nFill in the data:\n- Title - choose camera image title\n- Camera Entity - choose a camera entity from the drop-down list\n- Camera View - choose \"live\" to get less delay\n\nNext, switch to \"Code Editor\" mode by pressing the button at the bottom left side. You will see the following code:\n```shell\ncamera_view: live\ntype: picture-glance\ntitle: Kitchen\nimage: https://demo.home-assistant.io/stub_config/kitchen.png\nentities: []\ncamera_image: camera.tapo_mainstream\n```\n\nReplace the content of `entities: []` according to the example below (`<YOUR_CAMERA_ENTITY>` is the same as the `camera_image` parameter):\n\n<code-helper copy>\n\n```\nentities:\n  - entity: <YOUR_CAMERA_ENTITY>\n    tap_action:\n      action: call-service\n      service: onvif.ptz\n      service_data:\n        entity_id: <YOUR_CAMERA_ENTITY>\n        pan: LEFT\n        speed: 1\n        distance: 0.3\n        move_mode: ContinuousMove\n    name: Pan Left\n    show_state: false\n    icon: 'mdi:arrow-left'\n    show_icon: true\n  - entity: <YOUR_CAMERA_ENTITY>\n    tap_action:\n      action: call-service\n      service: onvif.ptz\n      service_data:\n        entity_id: <YOUR_CAMERA_ENTITY>\n        tilt: UP\n        speed: 1\n        distance: 0.3\n        move_mode: ContinuousMove\n    name: Tilt Up\n    icon: 'mdi:arrow-up'\n  - entity: <YOUR_CAMERA_ENTITY>\n    tap_action:\n      action: call-service\n      service: onvif.ptz\n      service_data:\n        entity_id: <YOUR_CAMERA_ENTITY>\n        tilt: DOWN\n        speed: 1\n        distance: 0.3\n        move_mode: ContinuousMove\n    name: Tilt Down\n    icon: 'mdi:arrow-down'\n  - entity: <YOUR_CAMERA_ENTITY>\n    tap_action:\n      action: call-service\n      service: onvif.ptz\n      service_data:\n        entity_id: <YOUR_CAMERA_ENTITY>\n        pan: RIGHT\n        speed: 1\n        distance: 0.3\n        move_mode: ContinuousMove\n    name: Pan Right\n    icon: 'mdi:arrow-right'\n    show_icon: true\n```\n\n</code-helper>\n\nThat's all. Now you should see the RTZ camera card on the dashboard along with control buttons.\n\n## Troubleshooting\nIf you are using Home Assistant Core and you don't see a stream from the camera, you should install \"stream\" and \"FFMPEG\" integrations. \nTo do this, you should add `stream: `  and `ffmpeg: ` strings to the end of configuration.yaml.","tools":[],"fileInfo":{"path":"ptz-camera.md","name":"ptz-camera"}}},"context":{}}