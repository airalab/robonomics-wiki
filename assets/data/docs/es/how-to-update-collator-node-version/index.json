{"hash":"43cdadfbe0ed6cb2a1300f58105ff56ac7d0dbc2","data":{"doc":{"id":"53af2021a80af17e9eceaf234cd60623","title":"Cómo actualizar la versión del nodo Robonomics Collator","description":"","contributors":["Leemo94"],"headings":[],"subtitles":[{"depth":2,"value":"","anchor":"#comandos-necesarios"},{"depth":2,"value":"","anchor":"#cambiar-la-base-de-datos-de-la-cadena-de-relevo-kusama-sin-establecer-una-ruta-base"}],"content":"\nSe recomienda haber leído los siguientes artículos antes de leer esta publicación: [\"Cómo construir un nodo Collator\"](/docs/how-to-build-collator-node) y [\"Cómo lanzar el Robonomics Collator\"](/docs/how-to-launch-the-robonomics-collator).\n\nEste artículo contiene los comandos necesarios para actualizar un nodo Collator de Robonomics (ejecutándose en Ubuntu), y también proporciona un ejemplo posteriormente.\n\n## **Comandos necesarios**\n\n0. Antes de comenzar, se recomienda que haya iniciado sesión como `root`, si no es así, entonces recomendaría que utilice:\n\n<code-helper copy>\n\n```shell\nsudo su -\n```\n\n</code-helper>\n\n1. Detenga el servicio de Robonomics:\n\n<code-helper copy>\n\n```shell\nsystemctl stop robonomics.service\n```\n\n</code-helper>\n\n2. Elimine la versión anterior de Robonomics (asegúrese de estar en el directorio correcto):\n\n<code-helper copy>\n\n```shell\nrm -f robonomics.X.X.X-ubuntu-x86_64.tar.gz\n```\n\n</code-helper>\n\n3. Obtenga la [última versión](https://github.com/airalab/robonomics/releases) de Robonomics:\n\n<code-helper copy>\n\n```shell\nwget https://github.com/airalab/robonomics/releases/vX.X.X/.....\n```\n</code-helper>\n\n\n4. Extraiga el archivo:\n\n<code-helper copy>\n\n```shell\ntar -xf robonomics-X.X.X-x86_64-unknown-linux.gnu.tar.gz\n```\n</code-helper>\n\n5. Mueva el archivo:\n\n<code-helper copy>\n\n```shell\nmv robonomics /usr/local/bin/\n```\n</code-helper>\n\n<robo-wiki-note type=\"note\">\n\nDebe mover este archivo al directorio correcto donde instaló el nodo Robonomics)\n\n</robo-wiki-note>\n\n6. Inicie Robonomics:\n\n<code-helper copy>\n\n```shell\nsystemctl start robonomics.service\n```\n</code-helper>\n\nEjemplo para actualizar el nodo Collator a Robonomics v1.8.4:\n\n<code-helper>\n\n```shell\nsudo su -\ncd /home/admin\nsystemctl stop robonomics.service\nrm -f robonomics-1.7.3-x86_64-unknown-linux-gnu.tar.gz\nwget https://github.com/airalab/robonomics/releases/download/v1.8.4/robonomics-1.8.4-x86_64-unknown-linux-gnu.tar.gz\ntar -xf robonomics-1.8.4-x86_64-unknown-linux-gnu.tar.gz\nmv robonomics /usr/local/bin/\nsystemctl start robonomics.service\n\n```\n</code-helper>\n\n## **Cambiar la base de datos de la cadena de relevo Kusama sin establecer una ruta base**\n\nHay momentos en los que ciertos snapshots de la cadena de relevo Kusama causan errores en su nodo. Esto a menudo hace que su nodo deje de funcionar. Ejemplo de error causado por una base de datos corrupta de la cadena de relevo:\n\n<code-helper>\n\n```shell\nDec 08 19:14:31 ns3159483 robonomics[1019836]: 2022-12-08 19:14:31 [Relaychain] GRANDPA voter error: could not complete a round on disk: Database\nDec 08 19:14:31 ns3159483 robonomics[1019836]: 2022-12-08 19:14:31 [Relaychain] Essential task `grandpa-voter` failed. Shutting down service.\nDec 08 19:14:32 ns3159483 robonomics[1019836]: Error: Service(Other(\"Essential task failed.\"))\nDec 08 19:14:32 ns3159483 systemd[1]: robonomics.service: Main process exited, code=exited, status=1/FAILURE\nDec 08 19:14:32 ns3159483 systemd[1]: robonomics.service: Failed with result 'exit-code'.\nec 08 19:14:33 ns3159483 robonomics[1022922]: Error: Service(Client(Backend(\"Invalid argument: Column families not opened: col12, col11, col10, col9, col8, col7, col6, col5, col4, col3, col2, col1, col0\")))\nDec 08 19:14:33 ns3159483 systemd[1]: robonomics.service: Main process exited, code=exited, status=1/FAILURE\nDec 08 19:14:33 ns3159483 systemd[1]: robonomics.service: Failed with result 'exit-code'.\n```\n</code-helper>\n\nPara solucionar este error, debe eliminar su base de datos existente de la cadena de relevo Kusama (probablemente RocksDb) y reemplazarla por otra base de datos como ParityDb. Ejecute los siguientes comandos:\n\n1. Encuentre el directorio del nodo Robonomics y verifique los archivos:\n\n<code-helper>\n\n```shell\ncd /home/robonomics/\nls -a\n```\n</code-helper>\n\n2. Confirme que ve el directorio polkadot y luego navegue hasta el directorio chains:\n\n<code-helper>\n\n```shell\ncd /polkadot/chains/\nls -a\n```\n</code-helper>\n\n3. Elimine el directorio `ksmcc3`:\n\n<code-helper copy>\n\n```shell\nrm -r ksmcc3\n```\n</code-helper>\n\n4. Cree un nuevo directorio `ksmcc3`.\n\n<code-helper>\n\n```shell\nmkdir ksmcc3\nchown -R robonomics:robonomics ksmcc3\ncd ksmcc3\n```\n\n</code-helper>\n\n5. Ahora debe descargar un nuevo snapshot. Este ejemplo utiliza un snapshot de la cadena de relevo altamente podado, pero puede cambiarlo por cualquier snapshot que prefiera.\n\n<code-helper copy>\n\n```shell\nwget wget https://snaps.sik.rocks/ksm_pruned.tar.gz\n```\n\n</code-helper>\n\n6. Mientras se descarga el snapshot, abra una nueva sesión y edite su archivo de servicio:\n\n\n<code-helper copy>\n\n```shell\nsudo nano /etc/systemd/system/robonomics.service\n```\n\n</code-helper>\n\nModifique las líneas dentro del archivo de servicio que se refieren a la base de datos y la poda:\n\n<code-helper copy>\n\n```shell\n  --database=paritydb \\\n  --state-pruning=100 \\\n  --blocks-pruning=100 \\\n  --execution=Wasm\n```\n\n</code-helper>\n\n  \nUse `Ctrl + S` y luego `Ctrl + X` para guardar y salir del archivo de servicio.\n\n7. Ahora debe recargar su daemon.\n\n<code-helper copy>\n\n```shell\nsystemctl daemon-reload\n```\n</code-helper>\n\n\n8. Para este momento, en su otra sesión, esperemos que se haya descargado la nueva base de datos, así que extraiga el archivo:\n\n<code-helper copy>\n\n```shell\ntar -xvzf ksm_pruned.tar.gz\n```\n\n</code-helper>\n\n9. Después de que se complete el desempaquetado, ejecute lo siguiente:\n\n<code-helper copy>\n\n\n```shell\nchown -R robonomics:robonomics paritydb\n```\n\n</code-helper>\n\n10. Ahora puede iniciar el servicio, monitorearlo en busca de errores y verificar que esté emparejado tanto en la cadena de relevo como en la parachain:\n\n\n<code-helper copy>\n\n\n```shell\nsystemctl start robonomics && journalctl -fu robonomics\n```\n</code-helper>","tools":[],"fileInfo":{"path":"es/how-to-update-collator-node-version.md","name":"how-to-update-collator-node-version"}}},"context":{}}