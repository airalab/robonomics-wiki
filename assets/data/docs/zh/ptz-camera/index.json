{"hash":"374e5e6bd3c921ba1dd42a764de57557a5b04902","data":{"doc":{"id":"30e56d9eb207abdfea41f942aa7432ce","title":"在Home Assistant中进行PTZ摄像机控制","description":"","contributors":["nakata5321"],"headings":[],"subtitles":[{"depth":2,"value":"ONVIF集成","anchor":"#onvif集成"},{"depth":2,"value":"将摄像机控制添加到仪表板","anchor":"#将摄像机控制添加到仪表板"},{"depth":2,"value":"故障排除","anchor":"#故障排除"}],"content":"\n本文介绍了在Home Assistant中设置PTZ摄像头的过程。\n将使用ONVIF协议。这需要一个本地摄像机账户。\n\n<robo-wiki-note type=\"warning\">\n本文不涵盖设置本地摄像机账户的过程。\n</robo-wiki-note>\n\n要求:\n- PTZ camera\n- 本地摄像机账户\n- 摄像机IP地址\n- 配置的Home Assistant\n\n## ONVIF集成\n\n让我们从**ONVIF集成**的安装开始。\n\n转到\"设置\"Settings\"\"Devices & Services\"，然后点击\"ADD INTEGRATION\"按钮。\n输入\"ONVIF\"并选择集成。您将看到下一个窗口。\n\n <robo-wiki-picture src=\"home-assistant/onvifsetup.jpg\" />\n\n点击\"Submit\"按钮。它将尝试自动搜索您的摄像机。如果成功， \n从列表中选择您的摄像机并填写空白字段。 \n否则，您必须手动填写所有字段。您将看到以下窗口。\n\n <robo-wiki-picture src=\"home-assistant/onvifconfig.jpg\" />\n\n填写空白处:\n- Name - 为您的摄像机命名\n- Host - 提供您的摄像机IP地址\n- Port - 通常是2020年最常见的，但您的摄像机供应商可能会更改它\n- Username - 为您的摄像机本地账户编写用户名\n  - Password - 为您的摄像机本地账户编写密码\n\n然后点击\"Submit\"。为您的摄像机选择一个区域，然后点击\"Finish\"。\n\n## 将摄像机控制添加到仪表板\n\n现在您已经完全设置好摄像机，可以将其流和控制按钮添加到仪表板。\n\n转到仪表板并开始创建一个新卡片。选择\"Picture Glance\"。\n\n <robo-wiki-picture src=\"home-assistant/glance.jpg\" />\n\n填写数据:\n- Title - 选择摄像机图像标题\n- Camera Entity - 从下拉列表中选择一个摄像机实体\n- Camera View - 选择\"live\"以减少延迟\n\n接下来，通过按下左下角的按钮切换到\"Code Editor\"模式。您将看到以下代码:\n```shell\ncamera_view: live\ntype: picture-glance\ntitle: Kitchen\nimage: https://demo.home-assistant.io/stub_config/kitchen.png\nentities: []\ncamera_image: camera.tapo_mainstream\n```\n\n根据下面的示例替换`entities: []`的内容（`<YOUR_CAMERA_ENTITY>`与`camera_image`参数相同）:\n\n<code-helper copy>\n\n```\nentities:\n  - entity: <YOUR_CAMERA_ENTITY>\n    tap_action:\n      action: call-service\n      service: onvif.ptz\n      service_data:\n        entity_id: <YOUR_CAMERA_ENTITY>\n        pan: LEFT\n        speed: 1\n        distance: 0.3\n        move_mode: ContinuousMove\n    name: Pan Left\n    show_state: false\n    icon: 'mdi:arrow-left'\n    show_icon: true\n  - entity: <YOUR_CAMERA_ENTITY>\n    tap_action:\n      action: call-service\n      service: onvif.ptz\n      service_data:\n        entity_id: <YOUR_CAMERA_ENTITY>\n        tilt: UP\n        speed: 1\n        distance: 0.3\n        move_mode: ContinuousMove\n    name: Tilt Up\n    icon: 'mdi:arrow-up'\n  - entity: <YOUR_CAMERA_ENTITY>\n    tap_action:\n      action: call-service\n      service: onvif.ptz\n      service_data:\n        entity_id: <YOUR_CAMERA_ENTITY>\n        tilt: DOWN\n        speed: 1\n        distance: 0.3\n        move_mode: ContinuousMove\n    name: Tilt Down\n    icon: 'mdi:arrow-down'\n  - entity: <YOUR_CAMERA_ENTITY>\n    tap_action:\n      action: call-service\n      service: onvif.ptz\n      service_data:\n        entity_id: <YOUR_CAMERA_ENTITY>\n        pan: RIGHT\n        speed: 1\n        distance: 0.3\n        move_mode: ContinuousMove\n    name: Pan Right\n    icon: 'mdi:arrow-right'\n    show_icon: true\n```\n\n</code-helper>\n\n就这样。现在您应该在仪表板上看到PTZ摄机卡片以及控制按钮.\n\n## 故障排除\n如果您正在使用Home Assistant Core，但是您没有看到来自摄像头的流，请安装\"stream\"和\"FFMPEG\"集成。 \n要做到这一点，您应该在configuration.yaml的末尾添加`stream: `和`ffmpeg: `字符串。","tools":[],"fileInfo":{"path":"zh/ptz-camera.md","name":"ptz-camera"}}},"context":{}}