{"hash":"8b2d9aa73f456db40d24ad81a01459a67669b759","data":{"doc":{"id":"3f962378485d2a6eb08295824613f265","title":"Connect Sensor To Robonomics Network","contributors":["LoSk-p","Vourhey","Ludovich88"],"translated":false,"headings":[],"subtitles":[{"depth":2,"value":"Hardware","anchor":"#hardware"},{"depth":2,"value":"Assembly","anchor":"#assembly"},{"depth":2,"value":"Firmware","anchor":"#firmware"},{"depth":3,"value":"For Linux","anchor":"#for-linux"},{"depth":3,"value":"For Windows:","anchor":"#for-windows"},{"depth":3,"value":"For MacOS.","anchor":"#for-macos"},{"depth":2,"value":"Setup","anchor":"#setup"},{"depth":2,"value":"Advanced Setup","anchor":"#advanced-setup"}],"content":"\n## Hardware\n\nUniversal board for air quality sensor, based on ESP8266 allows to use the following modules: NODEMCU v3, NODEMCU v2, WEMOS D1 MINI. The device is designed for 6 - 24 volt power supply, using DC-DC converter DC MINI560.\n\n![plata](../images/sensors-connectivity/plata.png)\n\nThis board allows you to connect PM sensors:\n\n- [SDS011](https://cdn-reichelt.de/documents/datenblatt/X200/SDS011-DATASHEET.pdf)\n\nPossibility of connection via I2C interface:\n\n- [BMP180](https://cdn-shop.adafruit.com/datasheets/BST-BMP180-DS000-09.pdf) - temperature and humidity\n- [BME/P280](https://www.mouser.com/datasheet/2/783/BST-BME280-DS002-1509607.pdf) - temperature, humidity, atmospheric pressure\n- [HTU21D](https://eu.mouser.com/ProductDetail/Measurement-Specialties/HTU21D?qs=tx5doIiTu8oixw1WN5Uy8A%3D%3D) - temperature and humidity\n- SHT3x(I2C) - temperature and humidity\n- [CCS811 VOC SENSOR](https://www.sciosense.com/wp-content/uploads/documents/Application-Note-Baseline-Save-and-Restore-on-CCS811.pdf) - volatile Organic Compounds, CO2 equivalent\n- LCD1602/ 2004 / OLED SSD1306 / SH1106 - supported displays\n\nPossibility of connection via 1 Wire interface:\n\n- DTH22(AM2302) - temperature and humidity\n- DS18B20 - temperature.\n\nThere is also a smaller MINI model with a trimmed down list of connectable devices. The source circuits for both models can be found at [full model](https://oshwlab.com/ludovich88/aira_sensor_rev0-1) and [MINI model](https://oshwlab.com/ludovich88/aira_sensor_d1_mini).\n\n> To obtain a ready-made board, contact the developers at vm@multi-agent.io or ping@airalab.org.\n\nAfter receiving/assembling the sensor, all that remains is to flash and configure it.\n\n## Assembly\n\nLet's take a closer look at the board:\nThe board has several connectors for connection - they are highlighted in blue and green. Consider the blue block of terminal blocks.\n![plata1](../images/sensors-connectivity/plata1.png)\n\nFrom left to right (all terminals are signed):\n- Terminal for connecting the power supply of the board. The recommended voltage is 12 volts.\n- Ground (point of zero potential). Serves both for connection of zero potential of the power supply, and for connection of sensors.\n- Supply of sensors. Configurable power output to which sensors are connected. The output can be set to 3.3 or 5 volts.\n- SDA terminal. Serial data line, is used to connect sensors via the I2C interface.\n- SSL/1-Wire terminal. Configurable terminal to which the serial clock line  is connected. Used to connect sensors via I2C or 1-Wire interface.\n\nSetting the power output for the sensor and selecting the interface is done by setting the jumpers, marked yellow in the image.\nThe jumpers are installed horizontally, the places for installing the jumpers are signed.\n\n***BE CAREFUL!!!*** You can choose the voltage for the power supply by setting only one jumper to 3.3 volts or 5 volts. Setting two jumpers to 3.3 and 5 volts will damage the device. The same rule works when choosing an interface for sensors, install only one jumper in place of I2C or 1-Wire. Installing two jumpers may damage the device.\n\nThere is also an additional block of Inputs In the image it is marked in green.\n\n> There is a power switch on the left side of the blue box to force the board to reboot. It is in the ON position by default.\n\n## Firmware\n\nOur firmware is based on the firmware from [Sensor.Community](https://github.com/opendata-stuttgart/sensors-software), with some sensors added and the data sending scheme changed. The source code can be found [at the link](https://github.com/LoSk-p/sensors-software/tree/master/airrohr-firmware). \n\nTo flash the sensor you can use `airrohr-flasher`. Download the executable for your operating system from [latest release](https://github.com/airalab/sensors-connectivity/releases).\n\n### For Linux\n\nFirst you need to add a user to the `dialout` group (for Ubuntu) to gain access to the USB port:\n\n```bash\nsudo usermod -a -G dialout $USER\n```\n\nAfter that, reboot the computer. Next, change the permissions of the file and run it:\n\n```bash\nchmod +x airrohr-flasher-linux\n./airrohr-flasher-linux\n```\n\n### For Windows:\nUnzip the flasher and double-click to run it. You will also need to install drivers for USB2serial (Windows 10 should start automatically):\n\n* Drivers for NodeMCU v3 (CH340): [Windows](http://www.wch.cn/downloads/file/5.html) ([2018/09/04 v3.4 mirror](https://d.inf.re/luftdaten/CH341SER.ZIP))\n\n### For MacOS.\nDownload the flasher and run it. You will also need to install the drivers for USB2serial: \n* Drivers for NodeMCU v3 (CH340): [macOS](http://www.wch.cn/downloads/file/178.html) ([2018/09/04 v1.4 mirror](https://d.inf.re/luftdaten/CH341SER_MAC.ZIP))\n\n---\n\nSelect the firmware (in English or Russian) and click `Upload`. Uploading the firmware will take some time.\n\n![flasher](../images/sensors-connectivity/7_flasher.jpg)\n\n## Setup\n\nAfter downloading the firmware, reboot the ESP (just disconnect and reconnect the USB).\n\nAfter a while after the reboot, ESP will create a Wi-Fi network called RobonomicsSensor-xxxxxxxxx. Connect to it from your phone or computer, then an authorization window will open (if it doesn't open in any browser go to 192.168.4.1). Select your Wi-Fi network from the list (or write it yourself if it's not on the list) and fill in the password field. Also write the coordinates of the place where the sensor will be installed in the field below:\n\n![guest](../images/sensors-connectivity/guest.jpg)\n\nClick `Save and restart`.\n\nThe board will connect to the specified Wi-Fi network and in a couple of minutes you will be able to see the data on [map](https://sensors.robonomics.network/#/):\n\n![map](../images/sensors-connectivity/14_map.jpg)\n\n## Advanced Setup\n\nFor a more detailed setup (you may need it to connect additional sensors or send data to your own server) you need to find the address of the sensor in your Wi-Fi network. To do this, you can use `airrohr-flasher` (your computer must be on the same network as the sensor is connected to). Start it and go to the `Discovery` tab, then press `Refresh`, wait a moment and your sensor address will appear.\n\n![addr](../images/sensors-connectivity/11_flaser2.jpg)\n\nDouble-click on this address (or type it into your browser), you will get to the sensor menu:\n\n![home](../images/sensors-connectivity/home.png)\n\nUnder the `Configuration` tab you can configure the sensors used:\n\n![sensors](../images/sensors-connectivity/sensors.png)\n\nAnd also set up sending to your own server. To do this, in the tab `APIs` uncheck `Robonomics` and check `Send to own API` and specify the server address and port (65 for sensors connectivity):\n\n![apis](../images/sensors-connectivity/apis_en.png)\n\nClick `Save and restart` to save the settings.\n\n\n"}},"context":{}}