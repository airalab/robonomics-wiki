{"hash":"f0c4f9a9cb5ad2f8ccd3358031883a3caf6ee289","data":{"doc":{"id":"46280e4d2286257ec5abb05b7df995bf","title":"Robonomics Video Service","description":"","contributors":["nakata5321"],"headings":[],"subtitles":[{"depth":2,"value":"Connect the Camera","anchor":"#connect-the-camera"},{"depth":3,"value":"Add to the Dashboard","anchor":"#add-to-the-dashboard"},{"depth":2,"value":"Check media folder","anchor":"#check-media-folder"},{"depth":2,"value":"Service Call","anchor":"#service-call"},{"depth":2,"value":"DAPP","anchor":"#dapp"}],"content":"\nThis article shows how to add an IP camera to Home Assistant and send videos to Robonomics Web Service.\n\nTo connect a camera to Home Assistant, you need to know its IP address and create a local camera account to connect to the RTSP stream.\n\n<robo-wiki-note type=\"warning\">\nSince this is done differently for each camera, this process is not considered in this article.\n</robo-wiki-note>\n\nRequirements:\n- IP camera\n- Configured local camera account\n- IP address of the camera\n- Configured Home Assistant\n\n<robo-wiki-note type=\"note\">\n\nThis article assumes that you have a general IP camera without RTZ (rotate, tilt, zoom) options. \nIf you have an RTZ camera, check [\"RTZ camera\" article](/docs/ptz-camera). And then come back to a second step here.\n\n</robo-wiki-note>\n\n## Connect the Camera\n\nFirst, you need to find out the URL for the RTSP stream of the camera. \nTo do so, try entering the following query on the Internet: \"<CAMERA_NAME> RTSP stream\".\nStream URL must start with `rtsp://<IP_Address>...`. \n\nThis article uses a \"Tapo\" camera and the stream path is `rtsp://<IP_Address>/stream1`.\n\nOpen Home Assistant and go to \"Settings\"-> \"Devices & Services\". Press the \"ADD INTEGRATION\" button and\nstart typing \"Generic Camera\" integration. Choose it.\n\n <robo-wiki-picture src=\"home-assistant/generic.jpg\" />\n\nIn the configuration window provide the following information:\n- Stream Source URL - The URL of camera's RTSP stream\n- Username - write a username of your local camera account\n- Password - write a password for your local camera account\n\n<robo-wiki-picture src=\"home-assistant/genericconf.jpg\" />\n\nScroll down the settings and press the \"Submit\" button.\n\nIn Preview window activate the checkbox \"This image looks good.\" and press the \"Submit\" button. Then - \"Finish\".\n\n<robo-wiki-picture src=\"home-assistant/preview-camera.jpg\" />\n\n### Add to the Dashboard\n\nAdditionally, you can add the stream to your dashboard. To do this, navigate to the dashboard and create a new card \n\"Picture Glance\". Further steps:\n- enter the \"Title\" you want\n- delete data from \"Image Path\"\n- select the camera in \"Camera Entity\"\n- in the \"Camera View\", select \"live\" so that there is less delay\n\nAnd save it.\n<robo-wiki-picture src=\"home-assistant/camera_picture_glance.jpg\" />\n\n## Check media folder\n\nBefore being sent to the Robonomics Video Service, the video must be saved in a folder, and Home Assistant must have access to this folder. \nThe easiest option in this case is to use a media pack, in which the Home Assistant stores all the media.\n\n- If you use HAOS or Pre-installed Image your Home Assistant **already has Media folder**.\n- If you use Home Assistant Core, you should go to `.homeassistant` folder and create `media` folder in it.\n- If you use Home Assistant Docker, add ` -v /PATH_TO_YOUR_MEDIA:/media \\` line to the Docker command.\n\nTo check that everything was set up correctly, go to the “Media” -> “local media” tab in your Home Assistant. \nYou should see an empty folder (no errors):\n\n<robo-wiki-picture src=\"home-assistant/media-folder.jpg\" />\n\n## Service Call\n\nTo send a video to Robonomics, you should call a dedicated service in Home Assistant. \nIn this article this is done manually, but you can create an automation for it.\n\nTo do this, go to \"Developer tools\" -> \"Services\" and find \"Robonomics: Save recording to Robonomics \".\n\n<robo-wiki-picture src=\"home-assistant/robonomics-service.jpg\" />\n\nIn \"Targets\" choose your camera entity.\nIn \"Path to save the recording\" you should provide an absolute path to the folder,\nwhere Home Assistant can save the video:\n- For Pre-installed image - `/home/homeassistant/.homeassistant/media`;\n- For HA OS or Home Assistant Docker- `/media`;\n- For Home Assistant Core - Path to previously created media folder.\n\nAdditionally, you can choose the recording Duration. \n\nFill in the data and call the service with the \"CALL SERVICE\" button.\n\n## DAPP\n\nTo view the resulted video go to [Robonomics DAPP](https://vol4tim.github.io/videostream/).\n\n<robo-wiki-picture src=\"home-assistant/video-dapp.jpg\" />\n\nPaste in your controller's account address and click the button below. Wait for the \"Search for Twins\" process. \nAs a result, you will get an IPFS CID with all recorded videos.\n\n<robo-wiki-picture src=\"home-assistant/video-ipfs.jpg\" />\n\nNext, select the controller account (or any other) from the drop-down list and sign a message for authorization in\nthe Web3 IPFS gateway to download all the videos. As a result, you will obtain all the videos recorded by your smart home.\n\n<robo-wiki-picture src=\"home-assistant/show-videos.jpg\" />\n\nSince all the videos in the folder are encrypted with the controller key, you need to insert it to decrypt videos.\nAfter that, the video playback button is activated. Click on it to download the video.\n\n<robo-wiki-picture src=\"home-assistant/video-seed.jpg\" />\n\n\n\n\n\n\n","tools":[],"fileInfo":{"path":"robonomics-video.md","name":"robonomics-video"}}},"context":{}}