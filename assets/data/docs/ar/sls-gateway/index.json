{"hash":"e70e5d83b59e22ac1f1f08820f9edc38637839ff","data":{"doc":{"id":"5a0920eab6f547563dbb7728c35a467e","title":"Robonomics SLS Gateway","description":"","contributors":["LoSk-p","Fingerling42","nakata5321"],"headings":[],"subtitles":[{"depth":2,"value":"البرامج الثابتة","anchor":"#البرامج-الثابتة"},{"depth":3,"value":"حل المشاكل","anchor":"#حل-المشاكل"},{"depth":2,"value":"التكوين","anchor":"#التكوين"},{"depth":2,"value":"ربط SLS بـ MQTT","anchor":"#ربط-sls-بـ-mqtt"},{"depth":2,"value":"ربط الأجهزة","anchor":"#ربط-الأجهزة"}],"content":"\n**في هذه المقالة ستقوم بإعداد بوابة Robonomics SLS. ستقوم بتثبيت البرامج المطلوبة للبوابة وتكوينها وربطها بـ Home Assistant.**\n\n<robo-wiki-picture src=\"home-assistant/sls_gateway.png\" />\n\n## البرامج الثابتة\n\nأولاً ، تحتاج إلى تثبيت برامج البرمجة الثابتة للبوابة. قم بتجهيز البوابة عن طريق ضبط المفاتيح `1` و `3` في الجزء السفلي من بوابة SLS على `ON` ، ويجب أن تكون الأخرى على `OFF`.\n\n<robo-wiki-picture src=\"home-assistant/sls-gateway-13.gif\" />\n\nقم بتوصيل البوابة بجهاز Raspberry Pi الخاص بك عبر منفذ USB type-C على البوابة.\n\n<robo-wiki-picture src=\"home-assistant/sls-rpi.gif\" />\n\nاستنسخ المستودع مع البرامج الثابتة على جهاز Raspberry Pi الخاص بك:\n\n<code-helper additionalLine=\"rasppi_username@rasppi_hostname\">\n\n```shell\ngit clone https://github.com/airalab/robonomics-hass-utils.git\n```\n\n</code-helper>\n\nانتقل إلى `robonomics-hass-utils/esp_firmware/linux`. لتفليش بوابة SLS ، تحتاج إلى تشغيل البرامج النصية `Clear` و `Flash_16mb`.\n\n<code-helper additionalLine=\"rasppi_username@rasppi_hostname\">\n\n```shell\ncd robonomics-hass-utils/esp_firmware/linux\nsudo chmod +x Clear.sh\nsudo chmod +x Flash_16mb.sh\n./Clear.sh\n./Flash_16mb.sh\n```\n\n</code-helper>\n\n### حل المشاكل\n\nإذا كنت تواجه مشاكل في تحديث برامج البرمجة الثابتة للبوابة ، فيجب عليك اتخاذ خطوات إضافية:\n\n1. تأكد من تثبيت وحدة pySerial:\n\n<code-helper additionalLine=\"rasppi_username@rasppi_hostname\">\n\n```shell\npip install pyserial\n```\n</code-helper>\n\n2. قم بمنح المستخدم الخاص بك حقوق الوصول إلى منفذ USB وأعد تشغيل الكمبيوتر:\n\n<code-helper additionalLine=\"rasppi_username@rasppi_hostname\">\n\n```shell\nsudo usermod -a -G dialout $USER\nsudo reboot\n```\n</code-helper>\n\n3. في بعض الحالات ، من الضروري تغيير إعداد النطاق الترددي في البرنامج النصي لتحديث البرامج الثابتة. افتح البرنامج النصي `Flash_16mb.sh` باستخدام محرر `nano` وقم بتغيير معلة الباود من `921600` إلى قيمة أصغر (على سبيل المثال ، `115200`).\n\n## التكوين\n\n1. قم بفصل بوابة SLS عن الكمبيوتر. ضبط المفاتيح على ظهر البوابة في الموضع الصحيح. يجب أن تكون المفاتيح `5` (RX Zigbee to ESP) و `6` (TX Zigbee to ESP) في الموضع `ON` ، ويجب أن تكون الأخرى على `OFF`. \n\n<robo-wiki-picture src=\"home-assistant/sls-gateway-56.gif\" />\n\n2. قم بتوصيل كابل الطاقة من النوع C. يجب أن يتحول الضوء المؤشر في الوسط إلى اللون الأخضر.\n\n<robo-wiki-picture src=\"home-assistant/sls-gateway-connect.gif\" />\n\n3. عند بدء التشغيل الأول ، ستبدأ البوابة في مشاركة Wi-Fi مع SSID `zgw****`. قم بالاتصال بشبكة الاتصال هذه. تذكر أن الإشارة قد تكون ضعيفة إلى حد ما ، لذا من الأفضل أن تبقى بوابة SLS أقرب إلى جهاز الكمبيوتر الخاص بك. \n\n<robo-wiki-picture src=\"home-assistant/sls-gateway-wifi.gif\" />\n\n4. إذا تمت الاتصال بنجاح ، فسيتم فتح واجهة الويب (أو يمكنك العثور عليها على عنوان 192.168.1.1). \n\n5. سترى صفحة `Wi-Fi Settings` . حدد شبكة Wi-Fi الخاصة بك وأدخل كلمة المرور. اضغط على زر `Apply`. ستعيد البوابة التشغيل وتتصل بشبكة Wi-Fi الخاصة بك. \n\n<robo-wiki-video autoplay loop controls :videos=\"[{src: 'https://cloudflare-ipfs.com/ipfs/QmSht6roENzrV6oqsQ1a5gp6GVCz54EDZdPAP8XVh9SCwH', type:'mp4'}]\" />\n\n6. ابحث عن عنوان IP المحلي لبوابة SLS للوصول إلى واجهة الويب. يمكنك استخدام تطبيق [Fing mobile app](https://www.fing.com/products) أو أداة [nmap CLI tool](https://vitux.com/find-devices-connected-to-your-network-with-nmap/) للعثور على ذلك. يجب أن يكون اسم البوابة كما يلي: `zgw****`. افتح واجهة الويب للبوابة عن طريق لصق عنوان IP البوابة في المتصفح.\n\n7. انتقل إلى `Setting` -> `Hardware` وتأكد من أن الإعدادات تبدو كما هو موضح في الصورة. قم بتصحيح الإعدادات إذا لزم الأمر وانقر على زر `Save`:\n\n<robo-wiki-video autoplay loop controls :videos=\"[{src: 'https://cloudflare-ipfs.com/ipfs/QmeSksMxU9xkvvK7f81WDAYULiMFokK7P7KDVYEjv2MHjn', type:'mp4'}]\" />\n\nالجدول مع القيم المطلوبة:\n\n| Field                    | Value              |\n|--------------------------|:-------------------|\n| Zigbee module            | TI                 |\n| Zigbee UART RX           | 22                 |\n| Zigbee UART TX           | 23                 |\n| Zigbee RST Pin           | 18                 |\n| Zigbee BSL Pin           | 19                 |\n| Service Button Pin       | 33 (pullUP - true) |\n| Number addressable leds  | 0                  |\n| Led Red (or addr)        | 21                 |\n| Led Green                | 5                  |\n| Led Blue                 | 27                 |\n| I2C SDA                  | 255                |\n| I2C SCL                  | 255                |\n\n8. ثم أعد تشغيل البوابة. اختر  `Actions` -> `Reboot system` في الزاوية العلوية اليمنى.\n\n9. تأكد من أن البوابة تعمل بشكل صحيح في نافذة معلومات Zigbee. يجب أن يكون حالة الجهاز `OK`.\n\n10. قم بتكوين إضافة الأجهزة تلقائيًا إلى Home Assistant. انتقل إلى `Zigbee` -> `Config` ثم اختر `Home Assistant MQTT Discovery` و `Clear States`. قم بحفظ التغييرات ومرة أخرى **أعد تشغيل** بوابة SLS.\n\n<robo-wiki-note type=\"warning\">\n\nإذا كان لديك بالفعل بوابة SLS نشطة في منزلك ، وتقوم الآن بتكوين بوابة أخرى ، فسيتعارضون مع بعضهم البعض. لحل هذه المشكلة ، تحتاج إلى تغيير القناة على الجهاز الجديد. للقيام بذلك ، انتقل إلى `Zigbee` -> `Config` وقم بتغيير القناة إلى قناة أخرى (على سبيل المثال ، القناة 15).\n\n</robo-wiki-note>\n\n<robo-wiki-video autoplay loop controls :videos=\"[{src: 'https://cloudflare-ipfs.com/ipfs/QmVZMB1xQeB6ZLfSR6aUrN6cRSF296s8CMJt7E2jBJ5MjZ', type:'mp4'}]\" />\n\n## ربط SLS بـ MQTT\n\nبعد تكوين بوابة SLS ، تحتاج إلى ربط بوابة SLS بـ Home Assistant. افتح واجهة الويب لبوابة SLS وانتقل إلى `Settings/Link` -> `MQTT Setup`:\n\n\nأضف عنوان وسيطك (عنوان جهاز Raspberry Pi مع Home Assistant في الشبكة المحلية ، يمكنك العثور عليه باستخدام تطبيق [Fing mobile app](https://www.fing.com/products) أو أداة [nmap CLI tool](https://vitux.com/find-devices-connected-to-your-network-with-nmap/)) ، والمنفذ (الافتراضي هو `1883`) واسم مستخدم وكلمة مرور وسيطك (التي قمت بإنشائها سابقًا) واسم الموضوع (يمكنك اختيار أي اسم). كما يجب أن يكون عنوان IP لجهاز Raspberry Pi ثابتًا. انقر على `Enable` و `Retain states`.\n\n<robo-wiki-video autoplay loop controls :videos=\"[{src: 'https://cloudflare-ipfs.com/ipfs/QmdNKDqwwy87VQEDDVsX5kpaDQm9wKKPEJUNJnhnjx6e5y', type:'mp4'}]\" />\n\nاحفظ التغييرات. الآن ستظهر الأجهزة تلقائيًا في Home Assistant.\n\n## ربط الأجهزة\n\nقم بتوصيل أجهزتك عن طريق الانتقال إلى `Zigbee` -> `Join`. ضع حساساتك في وضع الاقتران ، وأكثر الطرق الشائعة لتبديل الجهاز إلى وضع الاتصال هي الاستمرار في الضغط على زر الطاقة أو تشغيلها / إيقاف تغيلها 5 مرات. اضغط على زر `Enable Join` لبدء البحث عن أجهزة Zigbee. سترى حساسات نشطة.\n\n<robo-wiki-picture src=\"home-assistant/switch-device.gif\" />\n\n<robo-wiki-video autoplay loop controls :videos=\"[{src: 'https://cloudflare-ipfs.com/ipfs/Qmdq3PBNY88QbYYqakwSLG2vn3mVUom3w3wsSWfTd1pzJA', type:'mp4'}]\" />\n\n\nالآن يمكنك الانتقال إلى قسم [**اشتراك IoT**](/docs/sub-activate) وبدء تفعيل اشتراك Robonomics.\n","tools":["SLS Firmware 2022.08.13 https://github.com/airalab/robonomics-hass-utils"],"fileInfo":{"path":"ar/sls-gateway.md","name":"sls-gateway"}}},"context":{}}