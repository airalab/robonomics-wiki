{"hash":"fd33307ffa3ee0962368bc43c43e224bb441b179","data":{"doc":{"id":"72408c6a35f0d883c1ffe72eddf48ae4","title":"Connect ROS-compatibale Drone To Robonomics Parachain. Part 1. Launch by Transaction","headings":[{"value":"Connect ROS-compatibale Drone To Robonomics Parachain. Part 1. Launch by Transaction"}],"subtitles":[{"depth":1,"value":"Connect ROS-compatibale Drone To Robonomics Parachain. Part 1. Launch by Transaction","anchor":"#connect-ros-compatibale-drone-to-robonomics-parachain-part-1-launch-by-transaction"},{"depth":2,"value":"1. Find a simulation","anchor":"#1-find-a-simulation"},{"depth":2,"value":"2. Inspect ROS topics","anchor":"#2-inspect-ros-topics"},{"depth":2,"value":"3. Download controller package","anchor":"#3-download-controller-package"},{"depth":2,"value":"4. Manage accounts in DAPP","anchor":"#4-manage-accounts-in-dapp"},{"depth":3,"value":"5. Launching the drone under parachain control","anchor":"#5-launching-the-drone-under-parachain-control"}],"content":"# Connect ROS-compatibale Drone To Robonomics Parachain. Part 1. Launch by Transaction\n\n**In this article we will show that with the help of Robonomics tools you can control any ROS-compatitable device. We will find a random drone simulation package on the web and adjust it to run with Robonomics.**\n**Requirements:**\n- Ubuntu 18.04 LTS\n- ROS Melodic + Gazebo + RViz (installation manual [here](http://wiki.ros.org/melodic/Installation))\n- Robonomics node (binary file) (download latest release [here](https://github.com/airalab/robonomics/releases))\n\nThe entire process of coding this part of demo is presented in a video below.\n\nhttps://www.youtube.com/watch?v=fDpwhBasQ5o&feature=youtu.be\n\n## 1. Find a simulation\nLet's surf the web. Google for `ROS drone simulator`. The first link will mostly likely show you the `tum_simulator` page on [http://wiki.ros.org/tum_simulator](http://wiki.ros.org/tum_simulator)\n\n![tum_simulator](./images/drone-demo/tum_simulator.jpg \"tum_simulator\")\n\nIt's pretty outdated, so we better find a fork for our system. Google for `tum_simulator Ubuntu 18 Gazebo 9 fork`. The first result is a GitHub [repo](https://github.com/tahsinkose/sjtu-drone) with an appropriate package. Dowload it\n```\nmkdir -p drone_simulator_ws/src\ncd drone_simulator_ws/src\ngit clone https://github.com/tahsinkose/sjtu-drone\ncd ..\ncatkin build\n```\nDon’t forget to add source command to `~/.bashrc`:\n```\necho \"source /home/$USER/drone_simulator_ws/devel/setup.bash\" >> ~/.bashrc\nsource \"~/.bashrc\"\n```\nNow we can run the simulation to see what do we need to do to take the drone under parachain control.\n```\nroslaunch sjtu_drone simple.launch\n```\n\n## 2. Inspect ROS topics\nWhen the simulation is runnung, in a new tab run the following command to see the list of topics used by the drone:\n```\nrostopic list\n```\nLet's take a look at `/cmd_vel`, `/drone/takeoff` and `/drone/land`:\n```\nrostopic info /cmd_vel\nrostopic info /drone/takeoff\nrostopic info /drone/land\n```\n\n![topics_info](./images/drone-demo/topics_info.jpg \"topics_info\")\n\nAs may be seen, there should be messages of `Twist` and `Empty` types, they are parts of `std_msgs` and `geometry_msgs`, we'll use this in the controller. Shut the simulation for a while.\n## 3. Download controller package\nGlobally, the main difference from the casual ROS robot controller is a block of code, which checks all the transactions in the network using [Robonomics IO](https://wiki.robonomics.network/docs/rio-overview/). The package itself is available on GitHub. Download it and build the workspace:\n```\ncd ~/drone_simulator_ws/src\ngit clone https://github.com/PaTara43/drone_simulator_controller\ncd drone_simulator_controller/src\nchmod +x *.py\ncd ~/drone_simulator_ws/src\ncatkin build\n```\n## 4. Manage accounts in DAPP\nSince we are testing, let's create a local robonomics network node with robonomics binary file:\n```\n./robonomics --dev\n```\n**Important!** Before next launches it is necessary to remove a directory `db` with\n\n```\nrm -rf /home/$USER/.local/share/robonomics/chains/dev/db\n```\nAfter a successful launch create accounts following [this](/docs/create-account-in-dapp) manual. **Do not forget to save each account's seed and address! You will need them for transactions**. Add these addresses, seeds and path to robonomics binary file to file `config.config` in `robonomics_ws/src/robonomics_sample_controller/src`. Transfer some money (units) to these accounts:\n\n![balances](./images/drone-demo/balances.jpg \"balances\")\n### 5. Launching the drone under parachain control\nUp to now the **only thing running** should be the robonomics local node. In a separate terminal launch drone simulation:\n```\nroslaunch sjtu_drone simple.launch\n```\nRun the script:\n```\nrosrun drone_simulator_controller drone_sample_controller.py\n```\n\n![launched_drone](./images/drone-demo/launched_drone.jpg \"launched_drone\")\n\nNow you can send a transaction triggering the drone to start flying. To do so, you should use the Robonomics IO `write` subcommand of robonomics binary file:\n```\necho \"ON\" | ./robonomics io write launch -r <DRONE_ADDRESS> -s <EMPLOYER’S_KEY>\n```\nWhere `<DRONE_ADDRESS>`  and `<EMPLOYER’S_KEY>` are replaced with  previously saved strings accordingly.\nYou should see the log `\"Taking Off\"` and the drone should start flying:\n\n![flying](./images/drone-demo/flying.jpg \"flying\")\n\nThat's how any ROS-compatitable robot can be controlled by Robonomics parachain control. Proceed to [part 2](/docs/connect-any-ros-compatitable-robot-under-robonomics-parachain-control-2) to learn more\n"}},"context":{}}