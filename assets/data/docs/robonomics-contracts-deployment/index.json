{"hash":"241f25bd2e83e5470e1ad8f0bed93d1f63beb6ce","data":{"doc":{"id":"8d96b18517eca852fa55c47d53543329","title":"Contracts deployment","headings":[{"value":"Contracts deployment"}],"subtitles":[{"depth":1,"value":"Contracts deployment","anchor":"#contracts-deployment"}],"content":"# Contracts deployment\n\nRobonomics network works on top of the existing Ethereum network. The protocol is implemented by smart contracts. A source code is on [Github](https://github.com/airalab/robonomics_contracts). Airalab team deploys new version of contracts and supports a current one. \n\nIn this lesson we are going to learn more about these contracts. To do this we will deploy our test copy. Also we are going to use these contracts in the future lessons. \n\nYou need a client running Ethereum node. You can use either one of existing network (e.g. Mainnet, Ropsten, Kovan) or your local one. For testing purpose we suggest to use this [docker container](https://github.com/f-o-a-m/cliquebait) \n\n    $ docker run --rm -d -p 9545:8545 -p 9546:8546 foamspace/cliquebait:latest\n\nNext step is obtain a copy of robonomics contracts source code:\n\n    $ git clone --recursive https://github.com/airalab/robonomics_contracts\n\nA file truffle.js contains available networks for migration. We will work with development network. When you are in `robonomics_contracts` directory install dependencies and run a migration:\n\n    npm install // to install dependencies\n    truffle migrate --network development\n\nIt's time to learn how to create a new lighthouse. For more information about Robonomics network and Lighthouse in particular read [white paper](http://static.robonomics.network/docs/book-the-economy-of-robots-1-2017/robonomics.network-book-the-economy-of-robots-1-2017-en.pdf). Briefly lighthouse o distributes the running time of providers. Every lighthouse serves its own broadcast channel. Ask and Bid messages come into this channel. XRT tokens are used as a payment. \n\nWhen XRT contracts was deployed some tokens were issued on our account. Let's check the balance:\n\n    $ truffle --network development console\n    > xrt = XRT.at(XRT.address)\n    > xrt.balanceOf(web3.eth.accounts[0])\n\nAnd that's how we create a lighthouse:\n\n    > factory = LiabilityFactory.at(LiabilityFactory.address)\n    > tx = factory.createLighthouse(1000, 10, \"test\")\n    > tx.then(x => {laddress = x.logs[0].args.lighthouse})\n    > l = LighthouseLib.at(laddress)\n\nInstead of deploying a lighthouse contract every time we need a new one, we ask a factory to do this job. A `l` variable contains lighthouse instance. The lighthouse should be able to spend our tokens. Let's make an approve and check everything went well:\n\n    > xrt.approve(l.address,1000)\n    > xrt.allowance(web3.eth.accounts[0],l.address)\n\nAnd a very important step is become a worker:\n\n    > l.refill(1000)\n\nEach worker has to put a stake. In this case it's 1000 Wn.\n\nBelow is a table of our addresses:\n\n| Contract          | Address                                       | ENS name                          |\n|------------------ |--------------------------------------------   |---------------------------------- |\n| ENSRegistry       | 0x80c77a7de64a15450bb8cf45ece4fbb7bae6fb49    |                                   |\n| XRT               | 0x673583a369eb3a830a5571208cf6eb7ce83987f8    | xrt.3.robonomics.eth              |\n| LiabilityFactory  | 0x1b3190e00c1903266862af1f31714d4b81ef59b2    | factory.3.robonomics.eth          |\n| Lighthouse        | 0xd2b78c032b6c8851a8b6cbf950caa02a77618d8e    | test.lighthouse.3.robonomics.eth  |\n"}},"context":{}}