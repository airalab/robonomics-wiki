{"hash":"17ae70ace5c127d7566de96c625c1a5e5abab879","data":{"doc":{"id":"65f6712075bd81257f5df60d8c68b566","title":"Come aggiornare la versione del nodo collatore Robonomics","description":"","contributors":["Leemo94"],"headings":[],"subtitles":[{"depth":2,"value":"","anchor":"#comandi-richiesti"},{"depth":2,"value":"","anchor":"#modifica-del-database-della-catena-di-rilancio-kusama-senza-impostare-un-percorso-di-base"}],"content":"\nSi consiglia di leggere i seguenti articoli prima di leggere questo post: [\"Come costruire un nodo collatore\"](/docs/how-to-build-collator-node) e [\"Come avviare il collatore Robonomics\"](/docs/how-to-launch-the-robonomics-collator).\n\nQuesto articolo contiene i comandi necessari per aggiornare un nodo collatore Robonomics (in esecuzione su Ubuntu) e fornisce anche un esempio successivo.\n\n## **Comandi richiesti**\n\n0. Prima di iniziare, si consiglia di accedere come `root`, se non lo si è, allora si consiglia di utilizzare:\n\n<code-helper copy>\n\n```shell\nsudo su -\n```\n\n</code-helper>\n\n1. Arrestare il servizio Robonomics:\n\n<code-helper copy>\n\n```shell\nsystemctl stop robonomics.service\n```\n\n</code-helper>\n\n2. Rimuovere la versione precedente di Robonomics (assicurarsi di essere nella directory corretta):\n\n<code-helper copy>\n\n```shell\nrm -f robonomics.X.X.X-ubuntu-x86_64.tar.gz\n```\n\n</code-helper>\n\n3. Ottenere la [versione più recente](https://github.com/airalab/robonomics/releases) di Robonomics:\n\n<code-helper copy>\n\n```shell\nwget https://github.com/airalab/robonomics/releases/vX.X.X/.....\n```\n</code-helper>\n\n\n4. Estrarre il file:\n\n<code-helper copy>\n\n```shell\ntar -xf robonomics-X.X.X-x86_64-unknown-linux.gnu.tar.gz\n```\n</code-helper>\n\n5. Spostare il file:\n\n<code-helper copy>\n\n```shell\nmv robonomics /usr/local/bin/\n```\n</code-helper>\n\n<robo-wiki-note type=\"note\">\n\nÈ necessario spostare questo file nella directory corretta in cui è stato installato il nodo Robonomics)\n\n</robo-wiki-note>\n\n6. Avviare Robonomics:\n\n<code-helper copy>\n\n```shell\nsystemctl start robonomics.service\n```\n</code-helper>\n\nEsempio per l'aggiornamento del nodo collatore a Robonomics v1.8.4:\n\n<code-helper>\n\n```shell\nsudo su -\ncd /home/admin\nsystemctl stop robonomics.service\nrm -f robonomics-1.7.3-x86_64-unknown-linux-gnu.tar.gz\nwget https://github.com/airalab/robonomics/releases/download/v1.8.4/robonomics-1.8.4-x86_64-unknown-linux-gnu.tar.gz\ntar -xf robonomics-1.8.4-x86_64-unknown-linux-gnu.tar.gz\nmv robonomics /usr/local/bin/\nsystemctl start robonomics.service\n\n```\n</code-helper>\n\n## **Modifica del database della catena di rilancio Kusama senza impostare un percorso di base**\n\nCi sono momenti in cui determinati snapshot della catena di rilancio Kusama causano errori al tuo nodo. Questo spesso provoca l'arresto del nodo. Esempio di errore causato da un database della catena di rilancio corrotto:\n\n<code-helper>\n\n```shell\nDec 08 19:14:31 ns3159483 robonomics[1019836]: 2022-12-08 19:14:31 [Relaychain] GRANDPA voter error: could not complete a round on disk: Database\nDec 08 19:14:31 ns3159483 robonomics[1019836]: 2022-12-08 19:14:31 [Relaychain] Essential task `grandpa-voter` failed. Shutting down service.\nDec 08 19:14:32 ns3159483 robonomics[1019836]: Error: Service(Other(\"Essential task failed.\"))\nDec 08 19:14:32 ns3159483 systemd[1]: robonomics.service: Main process exited, code=exited, status=1/FAILURE\nDec 08 19:14:32 ns3159483 systemd[1]: robonomics.service: Failed with result 'exit-code'.\nec 08 19:14:33 ns3159483 robonomics[1022922]: Error: Service(Client(Backend(\"Invalid argument: Column families not opened: col12, col11, col10, col9, col8, col7, col6, col5, col4, col3, col2, col1, col0\")))\nDec 08 19:14:33 ns3159483 systemd[1]: robonomics.service: Main process exited, code=exited, status=1/FAILURE\nDec 08 19:14:33 ns3159483 systemd[1]: robonomics.service: Failed with result 'exit-code'.\n```\n</code-helper>\n\nPer risolvere questo errore, è necessario rimuovere il database esistente della catena di rilancio Kusama (probabilmente RocksDb) e sostituirlo con un altro Db come ParityDb. Eseguire i seguenti comandi:\n\n1. Trova la directory del nodo Robonomics e controlla i file:\n\n<code-helper>\n\n```shell\ncd /home/robonomics/\nls -a\n```\n</code-helper>\n\n2. Conferma di vedere la directory polkadot e quindi passa alla directory chains:\n\n<code-helper>\n\n```shell\ncd /polkadot/chains/\nls -a\n```\n</code-helper>\n\n3. Elimina la directory \"ksmcc3\":\n\n<code-helper copy>\n\n```shell\nrm -r ksmcc3\n```\n</code-helper>\n\n4. Crea una nuova directory `ksmcc3`.\n\n<code-helper>\n\n```shell\nmkdir ksmcc3\nchown -R robonomics:robonomics ksmcc3\ncd ksmcc3\n```\n\n</code-helper>\n\n5. Ora è necessario scaricare un nuovo snapshot. Questo esempio utilizza uno snapshot della catena di rilancio fortemente potato, ma è possibile sostituirlo con qualsiasi snapshot preferito.\n\n<code-helper copy>\n\n```shell\nwget wget https://snaps.sik.rocks/ksm_pruned.tar.gz\n```\n\n</code-helper>\n\n6. Mentre lo snapshot viene scaricato, apri una nuova sessione e modifica il tuo file di servizio:\n\n\n<code-helper copy>\n\n```shell\nsudo nano /etc/systemd/system/robonomics.service\n```\n\n</code-helper>\n\nModifica le righe all'interno del file di servizio che si riferiscono al database e alla potatura:\n\n<code-helper copy>\n\n```shell\n  --database=paritydb \\\n  --state-pruning=100 \\\n  --blocks-pruning=100 \\\n  --execution=Wasm\n```\n\n</code-helper>\n\n  \nUtilizza `Ctrl + S` e poi `Ctrl + X` per salvare ed uscire dal file di servizio.\n\n7. Ora è necessario ricaricare il tuo demone.\n\n<code-helper copy>\n\n```shell\nsystemctl daemon-reload\n```\n</code-helper>\n\n\n8. A questo punto, nella tua altra sessione, sperabilmente il nuovo Db è stato scaricato, quindi estrai il file:\n\n<code-helper copy>\n\n```shell\ntar -xvzf ksm_pruned.tar.gz\n```\n\n</code-helper>\n\n9. Dopo il completamento dell'estrazione, eseguire quanto segue:\n\n<code-helper copy>\n\n\n```shell\nchown -R robonomics:robonomics paritydb\n```\n\n</code-helper>\n\n10. Ora è possibile avviare il servizio, monitorarlo per eventuali errori e verificare che sia in collegamento sia con la catena di rilancio che con la parachain.\n\n\n<code-helper copy>\n\n\n```shell\nsystemctl start robonomics && journalctl -fu robonomics\n```\n</code-helper>","tools":[],"fileInfo":{"path":"it/how-to-update-collator-node-version.md","name":"how-to-update-collator-node-version"}}},"context":{}}