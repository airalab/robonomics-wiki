{"hash":"27d6626b76dcb92dd3ddfe09b4010e2c0ab01932","data":{"doc":{"id":"19f8cf3d5da341a8f1f074905b2b9779","title":"Получайте уведомления, когда дверь открывается","description":"","contributors":["nakata5321"],"headings":[],"subtitles":[{"depth":2,"value":"Уведомления от бота Telegram","anchor":"#уведомления-от-бота-telegram"},{"depth":2,"value":"Уведомление об открытии двери","anchor":"#уведомление-об-открытии-двери"}],"content":"\nВ этой статье вы установите интеграцию с ботом Telegram и настроите автоматизацию, которая будет отправлять уведомление на ваш аккаунт Telegram, когда дверь открывается.\n\n## Уведомления от бота Telegram\n\nДля начала вам необходимо создать личного бота в Telegram. Для этого зайдите к [специальному Telegram-боту @BotFather](https://t.me/botfather) и следуйте инструкциям.\nСохраните свой токен для доступа к HTTP API.\n\n<robo-wiki-video controls src=\"https://static.robonomics.network/wiki/bot-father.mp4\" />\n\n<robo-wiki-note type=\"warning\">\n\nСохраняйте свой токен **безопасно** и храните его **надежно**, он может быть использован любым для управления вашим ботом. \n\n</robo-wiki-note>\n\nСледующий шаг - найти ваш ***User Chat ID***. Для этого используйте следующего [GetIdsBot](https://t.me/getidsbot). \n\n<robo-wiki-video controls src=\"https://static.robonomics.network/wiki/get-id-bot.mp4\" />\n\nТеперь установим интеграцию \"Telegram broadcast\". Эта интеграция будет отправлять сообщения на ваш Telegram.\n\nДля предустановленного образа Robonomics, Docker Home Assistant или Ядро Home Assistant вам нужно отредактировать `configuration.yaml`. Подключитесь к Raspberry Pi через `ssh`:\n\n<robo-wiki-video controls src=\"https://static.robonomics.network/wiki/open-config.mp4\" />\n\n<code-helper additionalLine=\"rasppi_username@rasppi_hostname\" >\n\n```shell\nsudo -u homeassistant -H -s\ncd\ncd .homeassistant \nnano configuration.yaml\n```\n\n</code-helper >\n\nВставьте следующие строки в конец файла. Вставьте свой **ключ API бота** и **ваш User Chat ID**. Также создайте имя для вашего сервиса уведомлений:\n\n\n<code-helper copy >\n\n```shell\ntelegram_bot:\n  - platform: broadcast\n    api_key: <YOUR_API_KEY>\n    allowed_chat_ids:\n      -  <YOUR_USER_CHAT_ID> # 123456789  example id of a user\n      \nnotify:\n  - platform: telegram\n    name: <NOTIFIER_NAME>\n    chat_id: <YOUR_USER_CHAT_ID>\n```\n\n</code-helper >\n\n<robo-wiki-video controls src=\"https://static.robonomics.network/wiki/insert-config.mp4\" />\n\n**Сохраните конфигурацию и перезагрузите Home Assistant.**\n\n\nВ результате в вашем сервисе Home Assistant будет создан сервис, который будет отправлять любое сообщение в чат Telegram с вами. \nВы можете проверить это в меню Инструменты разработчика на веб-интерфейсе Home Assistant. \n\n<robo-wiki-video controls src=\"https://static.robonomics.network/wiki/telegram-result.mp4\" />\n\n##  Уведомление об открытии двери\n\nТеперь пришло время создать автоматизацию. Сначала вы импортируете чертеж в свой Home Assistant по этой ссылке.\n\n<code-helper copy>\n\n```shell\nhttps://github.com/airalab/home-assistant-blueprints/blob/main/door-opened-notifications/door-notifications.yaml\n```\n\n</code-helper >\n\n<robo-wiki-video controls src=\"https://static.robonomics.network/wiki/insert-blue.mp4\" />\n\nИ создайте автоматизацию.\n\n<robo-wiki-video controls src=\"https://static.robonomics.network/wiki/create-automation.mp4\" />\n\nТеперь вы будете получать сообщение от Telegram бота каждый раз, когда дверь открывается.\n\n<robo-wiki-note type=\"okay\">\nВы можете использовать эту автоматизацию с любыми дверями/окнами в вашем доме\n</robo-wiki-note>\n\n","tools":["Home Assistant 2022.11.3 https://github.com/home-assistant/core"],"fileInfo":{"path":"ru/door-notification.md","name":"door-notification"}}},"context":{}}