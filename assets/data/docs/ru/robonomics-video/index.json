{"hash":"27d6626b76dcb92dd3ddfe09b4010e2c0ab01932","data":{"doc":{"id":"54eacd6cb84cfb602bf873906a20ad85","title":"Robonomics Video Service","description":"","contributors":["nakata5321"],"headings":[],"subtitles":[{"depth":2,"value":"Подключите камеру","anchor":"#подключите-камеру"},{"depth":3,"value":"Добавьте на панель управления","anchor":"#добавьте-на-панель-управления"},{"depth":2,"value":"Проверьте папку медиафайлов","anchor":"#проверьте-папку-медиафайлов"},{"depth":2,"value":"Вызов сервиса","anchor":"#вызов-сервиса"},{"depth":2,"value":"DAPP","anchor":"#dapp"}],"content":"\nВ этой статье показано, как добавить IP-камеру в Home Assistant и отправить видео на Robonomics Web Service.\n\nЧтобы подключить камеру к Home Assistant, вам нужно знать ее IP-адрес и создать локальную учетную запись камеры для подключения к потоку RTSP.\n\n<robo-wiki-note type=\"warning\">\nПоскольку это делается по-разному для каждой камеры, этот процесс не рассматривается в данной статье.\n</robo-wiki-note>\n\nТребования:\n- IP-камера\n- Настроенная локальная учетная запись камеры\n- IP-адрес камеры\n- Настроенный Home Assistant\n\n<robo-wiki-note type=\"note\">\n\nВ этой статье предполагается, что у вас есть обычная IP-камера без опций RTZ (поворот, наклон, масштабирование). \nЕсли у вас есть камера RTZ, проверьте статью [\"Камера RTZ\"](/docs/ptz-camera). А затем вернитесь ко второму шагу здесь.\n\n</robo-wiki-note>\n\n## Подключите камеру\n\nFirst, you need to find out the URL for the RTSP stream of the camera. \nДля этого попробуйте ввести следующий запрос в Интернете: \"<ИМЯ_КАМЕРЫ> RTSP-поток\".\nURL потока должен начинаться с `rtsp://<IP_Адрес>...`. \n\nВ этой статье используется камера \"Tapo\", а путь потока - `rtsp://<IP_Адрес>/stream1`.\n\nОткройте Home Assistant и перейдите в \"Settings\"-> \"Devices & Services\". Нажмите кнопку \"ADD INTEGRATION\"  и\nначните вводить \"Generic Camera\". Выберите его.\n\n <robo-wiki-picture src=\"home-assistant/generic.jpg\" />\n\nВ окне конфигурации предоставьте следующую информацию:\n- Stream Source URL - URL потока RTSP камеры\n- Username - введите имя пользователя вашей локальной учетной записи камеры\n- Password - введите пароль для вашей локальной учетной записи камеры\n\n<robo-wiki-picture src=\"home-assistant/genericconf.jpg\" />\n\nПрокрутите вниз настройки и нажмите кнопку \"Submit\".\n\nВ окне предварительного просмотра активируйте флажок \"This image looks good.\" и нажмите кнопку \"Submit\". Затем - \"Finish\".\n\n<robo-wiki-picture src=\"home-assistant/preview-camera.jpg\" />\n\n### Добавьте на панель управления\n\nКроме того, вы можете добавить поток на свою панель управления. Для этого перейдите на панель управления и создайте новую карту \n\"Picture Glance\". Дальнейшие шаги:\n- введите желаемый \"Title\"\n- удалите данные из \"Image Path\"\n- выберите камеру в \"Camera Entity\"\n- в \"Camera View\" выберите \"live\", чтобы уменьшить задержку\n\nИ сохраните его.\n<robo-wiki-picture src=\"home-assistant/camera_picture_glance.jpg\" />\n\n## Проверьте папку медиафайлов\n\nПрежде чем отправить видео на Robonomics Video Service, видео должно быть сохранено в папке, и Home Assistant должен иметь доступ к этой папке. \nСамый простой вариант в этом случае - использовать медиапак, в котором Home Assistant хранит все медиафайлы.\n\n- Если вы используете HAOS или предустановленное изображение, ваш Home Assistant **уже имеет папку Media**.\n- Если вы используете Core Home Assistant, вам следует перейти в папку `.homeassistant` и создать в ней папку `media`.\n- Если вы используете Home Assistant Docker, добавьте строку ` -v /ПУТЬ_К_ВАШИМ_МЕДИА:/media \\` в команду Docker.\n\nЧтобы проверить, что все настроено правильно, перейдите на вкладку “Media” -> “local media” в вашем Home Assistant. \nВы должны увидеть пустую папку (без ошибок):\n\n<robo-wiki-picture src=\"home-assistant/media-folder.jpg\" />\n\n## Вызов сервиса\n\nЧтобы отправить видео на Robonomics, вы должны вызвать специальный сервис в Home Assistant. \nВ этой статье это делается вручную, но вы можете создать автоматизацию для этого.\n\nДля этого зайдите в `Developer tools` -> «Services» и найдите \"Robonomics: Save recording to Robonomics \".\n\n<robo-wiki-picture src=\"home-assistant/robonomics-service.jpg\" />\n\nВ \"Targets\" выберите сущность вашей камеры.\nВ \"Path to save the recording\" вы должны указать абсолютный путь к папке,\nгде Home Assistant может сохранить видео:\n- Для предустановленного изображения - `/home/homeassistant/.homeassistant/media`;\n- Для HA OS или Home Assistant Docker- `/media`;\n- Для Home Assistant Core - Путь к ранее созданной папке с медиафайлами.\n\nКроме того, вы можете выбрать продолжительность записи. \n\nЗаполните данные и вызовите сервис с помощью кнопки \"CALL SERVICE\".\n\n## DAPP\n\nЧтобы просмотреть полученное видео, перейдите на [Robonomics DAPP](https://vol4tim.github.io/videostream/).\n\n<robo-wiki-picture src=\"home-assistant/video-dapp.jpg\" />\n\nВставьте адрес вашего контроллера и нажмите кнопку ниже. Дождитесь процесса \"Search for Twins\". \nВ результате вы получите IPFS CID со всеми записанными видео.\n\n<robo-wiki-picture src=\"home-assistant/video-ipfs.jpg\" />\n\nЗатем выберите учетную запись контроллера (или любую другую) из выпадающего списка и подпишите сообщение для авторизации в\nвеб-портале Web3 IPFS, чтобы загрузить все видео. В результате вы получите все видео, записанные вашим умным домом.\n\n<robo-wiki-picture src=\"home-assistant/show-videos.jpg\" />\n\nПоскольку все видео в папке зашифрованы с помощью ключа контроллера, вам нужно вставить его для расшифровки видео.\nПосле этого кнопка воспроизведения видео активируется. Нажмите на нее, чтобы скачать видео.\n\n<robo-wiki-picture src=\"home-assistant/video-seed.jpg\" />\n\n\n\n\n\n\n","tools":[],"fileInfo":{"path":"ru/robonomics-video.md","name":"robonomics-video"}}},"context":{}}