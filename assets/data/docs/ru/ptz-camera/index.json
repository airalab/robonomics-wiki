{"hash":"1ca1c2e9eb79a0e8c67655508915b5798519f749","data":{"doc":{"id":"a43d90e7199ef7700edfd7b53c3c2e69","title":"Управление PTZ-камерой в Home Assistant","description":"","contributors":["nakata5321"],"headings":[],"subtitles":[{"depth":2,"value":"Интеграция ONVIF","anchor":"#интеграция-onvif"},{"depth":2,"value":"Добавьте управление камерой на панель инструментов","anchor":"#добавьте-управление-камерой-на-панель-инструментов"},{"depth":2,"value":"Устранение неполадок","anchor":"#устранение-неполадок"}],"content":"\nВ этой статье рассматривается процесс настройки PTZ-камеры в Home Assistant. \nБудет использоваться протокол ONVIF. Для этого требуется локальная учетная запись камеры.\n\n<robo-wiki-note type=\"warning\">\nПроцесс настройки локальной учетной записи камеры не рассматривается в этой статье.\n</robo-wiki-note>\n\nТребования:\n- PTZ-камера\n- Локальная учетная запись камеры\n- IP-адрес камеры\n- Настроенный Home Assistant\n\n## Интеграция ONVIF\n\nДавайте начнем с установки **интеграции ONVIF**. \n\nПерейдите в раздел \"Devices & Services\" в \"Settings\" и нажмите кнопку \"ADD INTEGRATION\".\nВведите \"ONVIF\" и выберите интеграцию. Вы увидите следующее окно.\n\n <robo-wiki-picture src=\"home-assistant/onvifsetup.jpg\" />\n\nНажмите кнопку \"Submit\". Она попытается автоматически найти вашу камеру. Если успешно, \nвыберите свою камеру из списка и заполните пустые поля. \nВ противном случае вам придется заполнить все поля вручную. Вы увидите следующее окно.\n\n <robo-wiki-picture src=\"home-assistant/onvifconfig.jpg\" />\n\nЗаполните пробелы:\n- Name - дайте имя вашей камере\n- Host - укажите IP-адрес вашей камеры\n- Port - обычно это 2020 год, но ваш поставщик камеры может изменить его\n- Username - напишите имя пользователя вашей локальной учетной записи камеры\n- Password - напишите пароль для вашей локальной учетной записи камеры\n\nи нажмите \"Submit\". Выберите область для вашей камеры и нажмите \"Завершить\".\n\n## Добавьте управление камерой на панель инструментов\n\nТеперь, когда вы полностью настроили камеру, вы можете добавить ее поток и кнопки управления на панель инструментов.\n\nПерейдите на панель инструментов и начните с создания новой карты. Выберите \"Picture Glance\".\n\n <robo-wiki-picture src=\"home-assistant/glance.jpg\" />\n\nЗаполните данные:\n- Title - выберите заголовок изображения камеры\n- Camera Entity - выберите сущность камеры из выпадающего списка\n- Camera View - выберите \"live\", чтобы получить меньшую задержку\n\nЗатем переключитесь в режим \"Code Editor\", нажав кнопку в левом нижнем углу. Вы увидите следующий код:\n```shell\ncamera_view: live\ntype: picture-glance\ntitle: Kitchen\nimage: https://demo.home-assistant.io/stub_config/kitchen.png\nentities: []\ncamera_image: camera.tapo_mainstream\n```\n\nЗамените содержимое `entities: []` в соответствии с примером ниже (`<YOUR_CAMERA_ENTITY>` такой же, как параметр `camera_image`):\n\n<code-helper copy>\n\n```\nentities:\n  - entity: <YOUR_CAMERA_ENTITY>\n    tap_action:\n      action: call-service\n      service: onvif.ptz\n      service_data:\n        entity_id: <YOUR_CAMERA_ENTITY>\n        pan: LEFT\n        speed: 1\n        distance: 0.3\n        move_mode: ContinuousMove\n    name: Pan Left\n    show_state: false\n    icon: 'mdi:arrow-left'\n    show_icon: true\n  - entity: <YOUR_CAMERA_ENTITY>\n    tap_action:\n      action: call-service\n      service: onvif.ptz\n      service_data:\n        entity_id: <YOUR_CAMERA_ENTITY>\n        tilt: UP\n        speed: 1\n        distance: 0.3\n        move_mode: ContinuousMove\n    name: Tilt Up\n    icon: 'mdi:arrow-up'\n  - entity: <YOUR_CAMERA_ENTITY>\n    tap_action:\n      action: call-service\n      service: onvif.ptz\n      service_data:\n        entity_id: <YOUR_CAMERA_ENTITY>\n        tilt: DOWN\n        speed: 1\n        distance: 0.3\n        move_mode: ContinuousMove\n    name: Tilt Down\n    icon: 'mdi:arrow-down'\n  - entity: <YOUR_CAMERA_ENTITY>\n    tap_action:\n      action: call-service\n      service: onvif.ptz\n      service_data:\n        entity_id: <YOUR_CAMERA_ENTITY>\n        pan: RIGHT\n        speed: 1\n        distance: 0.3\n        move_mode: ContinuousMove\n    name: Pan Right\n    icon: 'mdi:arrow-right'\n    show_icon: true\n```\n\n</code-helper>\n\nВот и все. Теперь вы должны увидеть карту PTZ-камеры на панели инструментов вместе с кнопками управления.\n\n## Устранение неполадок\nЕсли вы используете Ядро Home Assistant и не видите поток с камеры, вам следует установить интеграции `stream` и `FFMPEG`. \nДля этого вам нужно добавить строки `stream: ` и `ffmpeg: ` в конец configuration.yaml.","tools":[],"fileInfo":{"path":"ru/ptz-camera.md","name":"ptz-camera"}}},"context":{}}