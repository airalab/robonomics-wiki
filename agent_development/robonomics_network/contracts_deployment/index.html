



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.5.1">
    
    
      
        <title>Contracts Deployment - Robonomics</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.1b62728e.css">
      
      
    
    
      <script src="../../../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#contracts-deployment" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../.." title="Robonomics" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Robonomics
            </span>
            <span class="md-header-nav__topic">
              
                Contracts Deployment
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../.." title="Robonomics" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Robonomics
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Try it out
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Try it out
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../try_it_out/get_open_data_from_sensor/" title="Get Open Data from Sensor" class="md-nav__link">
      Get Open Data from Sensor
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Cases
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Cases
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cases/connect_sen0233_to_robonomics/" title="Connect SEN0233 Sensor to Robonomics" class="md-nav__link">
      Connect SEN0233 Sensor to Robonomics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Learn
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Learn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1" type="checkbox" id="nav-4-1">
    
    <label class="md-nav__link" for="nav-4-1">
      AIRA
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-1">
        AIRA
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../aira/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../aira/installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../aira/basic_usage/" title="Basic Usage" class="md-nav__link">
      Basic Usage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../aira/connecting_via_ssh/" title="Connecting via SSH" class="md-nav__link">
      Connecting via SSH
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../aira/faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../aira/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2" checked>
    
    <label class="md-nav__link" for="nav-4-2">
      Agent Development
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Agent Development
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-1" type="checkbox" id="nav-4-2-1" checked>
    
    <label class="md-nav__link" for="nav-4-2-1">
      Robonomics Network
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-2-1">
        Robonomics Network
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../how_it_works/" title="How It Works" class="md-nav__link">
      How It Works
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="./" title="Contracts Deployment" class="md-nav__link md-nav__link--active">
      Contracts Deployment
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../become_a_provider/" title="Become a Provider" class="md-nav__link">
      Become a Provider
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../market_messages/" title="Market Messages" class="md-nav__link">
      Market Messages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-3" type="checkbox" id="nav-4-2-3">
    
    <label class="md-nav__link" for="nav-4-2-3">
      ROS API Reference
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-2-3">
        ROS API Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/robonomics_liability/" title="Robonomics Liability" class="md-nav__link">
      Robonomics Liability
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/robonomics_liability_msgs/" title="Robonomics Liability Messages" class="md-nav__link">
      Robonomics Liability Messages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/ethereum_common/" title="Ethereum Common" class="md-nav__link">
      Ethereum Common
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/ethereum_common_msgs/" title="Ethereum Common Messages" class="md-nav__link">
      Ethereum Common Messages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/ipfs_common/" title="IPFS Common" class="md-nav__link">
      IPFS Common
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/ipfs_common_msgs/" title="IPFS Common Messages" class="md-nav__link">
      IPFS Common Messages
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/" title="Examples" class="md-nav__link">
      Examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-5" type="checkbox" id="nav-4-2-5">
    
    <label class="md-nav__link" for="nav-4-2-5">
      Hardware Examples
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-2-5">
        Hardware Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../hardware_examples/connect_simple_cps/" title="Connect the Simplest CPS" class="md-nav__link">
      Connect the Simplest CPS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../hardware_examples/passing_dynamic_parameters/" title="Passing Dynamic Parameters" class="md-nav__link">
      Passing Dynamic Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../hardware_examples/connect_sensor/" title="Connect an Air Pollution Sensor" class="md-nav__link">
      Connect an Air Pollution Sensor
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      Robonomics-js
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        Robonomics-js
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../robonomics-js/beginning/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../robonomics-js/howto/" title="How to" class="md-nav__link">
      How to
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../robonomics-js/creating_dapp/" title="Creating Dapp" class="md-nav__link">
      Creating Dapp
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="contracts-deployment">Contracts Deployment</h1>
<p>Robonomics network works on top of the existing Ethereum network. The protocol is implemented by smart contracts. A source code is on <a href="https://github.com/airalab/robonomics_contracts">Github</a>. Airalab team deploys new version of contracts and supports a current one. </p>
<p>In this lesson we are going to learn more about these contracts. To do this we will deploy our test copy. Also we are going to use these contracts in the future lessons. </p>
<p>You need a client running Ethereum node. You can use either one of existing network (e.g. Mainnet, Ropsten, Kovan) or your local one. For testing purpose we suggest to use this <a href="https://github.com/f-o-a-m/cliquebait">docker container</a> </p>
<div class="codehilite"><pre><span></span>$ docker run --rm -d -p 9545:8545 -p 9546:8546 foamspace/cliquebait:latest
</pre></div>


<p>Next step is obtain a copy of robonomics contracts source code:</p>
<div class="codehilite"><pre><span></span>$ git clone --recursive https://github.com/airalab/robonomics_contracts
</pre></div>


<p>A file truffle.js contains available networks for migration. We will work with development network. When you are in <code>robonomics_contracts</code> directory install dependencies and run a migration:</p>
<div class="codehilite"><pre><span></span>npm install // to install dependencies
truffle migrate --network development
</pre></div>


<p>It's time to learn how to create a new lighthouse. For more information about Robonomics network and Lighthouse in particular read <a href="https://robonomics.network/robonomics_white_paper_en.pdf">white paper</a>. Briefly lighthouse o distributes the running time of providers. Every lighthouse serves its own broadcast channel. Ask and Bid messages come into this channel. XRT tokens are used as a payment. </p>
<p>When XRT contracts was deployed some tokens were issued on our account. Let's check the balance:</p>
<div class="codehilite"><pre><span></span>$ truffle --network development console
&gt; xrt = XRT.at(XRT.address)
&gt; xrt.balanceOf(web3.eth.accounts[0])
</pre></div>


<p>And that's how we create a lighthouse:</p>
<div class="codehilite"><pre><span></span>&gt; factory = LiabilityFactory.at(LiabilityFactory.address)
&gt; tx = factory.createLighthouse(1000, 10, &quot;test&quot;)
&gt; tx.then(x =&gt; {laddress = x.logs[0].args.lighthouse})
&gt; l = LighthouseLib.at(laddress)
</pre></div>


<p>Instead of deploying a lighthouse contract every time we need a new one, we ask a factory to do this job. A <code>l</code> variable contains lighthouse instance. The lighthouse should be able to spend our tokens. Let's make an approve and check everything went well:</p>
<div class="codehilite"><pre><span></span>&gt; xrt.approve(l.address,1000)
&gt; xrt.allowance(web3.eth.accounts[0],l.address)
</pre></div>


<p>And a very important step is become a worker:</p>
<div class="codehilite"><pre><span></span>&gt; l.refill(1000)
</pre></div>


<p>Each worker has to put a stake. In this case it's 1000 Wn.</p>
<p>Below is a table of our addresses:</p>
<table>
<thead>
<tr>
<th>Contract</th>
<th>Address</th>
<th>ENS name</th>
</tr>
</thead>
<tbody>
<tr>
<td>ENSRegistry</td>
<td>0x80c77a7de64a15450bb8cf45ece4fbb7bae6fb49</td>
<td></td>
</tr>
<tr>
<td>XRT</td>
<td>0x673583a369eb3a830a5571208cf6eb7ce83987f8</td>
<td>xrt.3.robonomics.eth</td>
</tr>
<tr>
<td>LiabilityFactory</td>
<td>0x1b3190e00c1903266862af1f31714d4b81ef59b2</td>
<td>factory.3.robonomics.eth</td>
</tr>
<tr>
<td>Lighthouse</td>
<td>0xd2b78c032b6c8851a8b6cbf950caa02a77618d8e</td>
<td>test.lighthouse.3.robonomics.eth</td>
</tr>
</tbody>
</table>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../how_it_works/" title="How It Works" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                How It Works
              </span>
            </div>
          </a>
        
        
          <a href="../become_a_provider/" title="Become a Provider" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Become a Provider
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/airalab/" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/AIRA_Robonomics" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.8e03edeb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
    
  </body>
</html>